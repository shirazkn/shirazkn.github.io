<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Hilbert Spaces | Shiraz</title>
<meta name="keywords" content="Linear Algebra">
<meta name="description" content="A Hilbert space is a vector space that has an inner product and that it is complete, i.e., it doesn&rsquo;t have holes in it. Inner product spaces have a rich geometric structure, and so do Hilbert spaces. The Euclidean space is an obvious example, where the inner product is just the dot product.">
<meta name="author" content="">
<link rel="canonical" href="https://shirazkn.github.io/posts/hilbert-spaces/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.1a4db4a1c89b16f8ffc6902fafe4043fa0b8fb3e0d2eed5fc6e48e79f66a6097.css" integrity="sha256-Gk20ocibFvj/xpAvr&#43;QEP6C4&#43;z4NLu1fxuSOefZqYJc=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://shirazkn.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://shirazkn.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://shirazkn.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://shirazkn.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://shirazkn.github.io/favicon.ico">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://shirazkn.github.io/posts/hilbert-spaces/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><script>
(function() {
    var pref = localStorage.getItem("pref-theme");
    if (pref === "dark" || (!pref && window.matchMedia("(prefers-color-scheme: dark)").matches)) {
        document.documentElement.classList.add("dark");
    }
})();
</script>

<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      packages: {'[+]': ['mathtools', 'amscd']},
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['\\(', '\\)'], ['$', '$']]  
    },
    loader:{
      load: ['ui/safe', '[tex]/mathtools', '[tex]/amscd']
    },
  };
</script>

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IM+Fell+DW+Pica">

<meta property="og:url" content="https://shirazkn.github.io/posts/hilbert-spaces/">
  <meta property="og:site_name" content="Shiraz">
  <meta property="og:title" content="Hilbert Spaces">
  <meta property="og:description" content="A Hilbert space is a vector space that has an inner product and that it is complete, i.e., it doesn’t have holes in it. Inner product spaces have a rich geometric structure, and so do Hilbert spaces. The Euclidean space is an obvious example, where the inner product is just the dot product.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-04-21T12:09:09-04:00">
    <meta property="article:modified_time" content="2023-04-21T12:09:09-04:00">
    <meta property="article:tag" content="Linear Algebra">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hilbert Spaces">
<meta name="twitter:description" content="A Hilbert space is a vector space that has an inner product and that it is complete, i.e., it doesn&rsquo;t have holes in it. Inner product spaces have a rich geometric structure, and so do Hilbert spaces. The Euclidean space is an obvious example, where the inner product is just the dot product.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://shirazkn.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Hilbert Spaces",
      "item": "https://shirazkn.github.io/posts/hilbert-spaces/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Hilbert Spaces",
  "name": "Hilbert Spaces",
  "description": "A Hilbert space is a vector space that has an inner product and that it is complete, i.e., it doesn\u0026rsquo;t have holes in it. Inner product spaces have a rich geometric structure, and so do Hilbert spaces. The Euclidean space is an obvious example, where the inner product is just the dot product.",
  "keywords": [
    "Linear Algebra"
  ],
  "articleBody": "Let $\\mathcal X$ be a Hilbert space, which means that it is a vector space that has an inner product (denoted by $\\langle \\cdot, \\cdot\\rangle _\\mathcal X$) and that it is complete, i.e., it doesn’t have er… holes in it. Recall that inner product spaces have a rich geometric structure, and so do Hilbert spaces. The Euclidean space $\\mathbb R^n$ is an obvious example, where the inner product is just the dot product. Mathematicians sometimes use ‘Hilbert space’ to refer specifically to infinite-dimensional inner product spaces, but for our purposes, we will let ‘Hilbert space’ include the finite-dimensional case.\nSome interesting Hilbert spaces are given below. Each of these spaces has a corresponding norm, $\\lVert x \\rVert_{\\mathcal X}=\\sqrt{\\langle x, x\\rangle}_{\\mathcal X}$, which we call as the norm that is induced by the inner product.\nHilbert Space $\\mathcal X$ Inner Product $\\langle \\cdot, \\cdot\\rangle _\\mathcal X$ Numbers $a$, $b\\in \\mathbb R$ $ab$ Random Variables $X,Y\\in \\mathbb R$ $\\mathbb E \\left[XY \\right]$ Real Vectors $x$, $y\\in \\mathbb R^n$ $\\mathbf x^\\intercal \\mathbf y$ Complex Vectors $x$, $y\\in \\mathbb C^n$ $\\mathbf x^\\dagger \\mathbf y$ Matrices $\\mathbf A$, $\\mathbf B\\in \\mathbb R^{m\\times n}$ $\\ \\text{Trace}(\\mathbf A^{\\intercal}\\mathbf B)$ Sequences $(x_i)_{i=1}^{\\infty}, (y_i)_{i=1}^{\\infty}\\in \\ell ^2(\\mathbb R) \\ $ $\\sum_{i=1}^{\\infty} x_i y_i$ Square-Integrable Functions $f,g \\in L^2(\\mathbb R)$ $\\int_{-\\infty}^{\\infty}f(x)\\overline{g(x)}dx$ Here, $\\overline{({}\\cdot{})}$ is the conjugate of a complex number (where you replace $i$ with $-i$), $({}\\cdot{})^\\dagger =\\overline{({}\\cdot{})}^\\intercal $ is called the conjugate transpose of a complex vector.\nProjections A defining feature of Hilbert Spaces is their geometry. Because they have notions of angles , we have\n$$ 0 \\leq {|\\langle x, y\\rangle_{\\mathcal X} |} \\leq {\\|x\\|\\|y\\|} $$where if the first equality holds we say $x$ and $y$ are orthogonal to each other, and the second equality holds if and only if they are linearly dependent: $x = a y$ for $a \\in \\mathbb R$ (or $\\mathbb C$, when $\\mathcal X$ is a complex vector space).\nWe can define the projection of an element $x\\in \\mathcal X$ onto a subspace $S\\subseteq \\mathcal X$:\n\\[ \\text{P}_S(x) = \\mathrm{argmin}_{y\\in S}\\|x-y\\|_{\\mathcal X}\\] where $\\lVert v \\rVert_{\\mathcal X} = \\sqrt{\\langle v, v\\rangle}_{\\mathcal X}$ is the induced norm. A remarkable by-product of these definitions of angles, orthogonality, and projection, is that it is consistent with our Euclidean intuition: $x-\\text{P}_S(x)$ is always orthogonal to $S$. A related theorem says that $\\text P_{\\tilde S}(x)$ is well-defined and unique even if $\\tilde S \\subseteq \\mathcal X$ is a closed convex set, although in this case we do not have orthogonality of $x-\\text{P}_{\\tilde S}(x)$ to the other elements in $\\tilde S$.\nAs an example, given two ‘vectors’ $X$ and $Y$ in the Hilbert space of random variables, orthogonality corresponds to $\\mathbb E\\left[X Y\\right] = 0$ and the norm becomes the variance. In this case, orthogonal projection actually gives the least-squares estimator of given a random variable ( Lec. 22, p. 85 ). More generally, a projection can be used to compute the best approximation of an element of a Hilbert space (namely, the point being projected), with the approximation constrained to lie on a subspace (or a closed convex set).\nThe $(\\mathbb R^N, \\lVert{}\\cdot{}\\rVert_2)$ Space of Sequences Given a vector in the Euclidean space $\\mathbb R^N$ (equipped with a basis), we can view it as a set of $N$ coefficients. Each coefficient (a real number) describes the vector’s distance along the corresponding basis vector (or ‘axis’, if you will).\nTaking a few steps back, let’s begin by viewing $\\mathbb R^N$ as the set-theoretic product $\\mathbb R \\times \\mathbb R \\times \\dots \\times \\mathbb R$. An element $x$ of this space is a sequence of real numbers,\n\\[x = (x_1, x_2, \\dots, x_N).\\] Once we define notions of addition and scalar multiplication for such $N$-coefficient sequences, we are allowed to call $\\mathbb R^N$ a vector space. A norm for $\\mathbb R^N$ can be defined as $\\left(\\sum_{i=1}^N |x_i|^2\\right)^{1/2}$, which automatically induces a topology (notion of open and closed sets) on $\\mathbb R^N$. We can generalize all of this as $N\\rightarrow \\infty$.\nThe $\\ell^2$ Space of Sequences $\\ell^2(\\mathbb R)$ consists of countable sequences of real numbers. ‘Countable’ here means that we can count them like we can count the natural numbers, but they are infinitely long nonetheless. We denote one such sequence as $(x_i)_{i=1}^{\\infty}$. A sequence is in $\\ell^2$ if and only if it is square-summable, which means\n\\[ \\sum_{i=1}^{\\infty}|x_i|^2 \u003c \\infty \\]\nA sequence which is not in $\\ell^2$ (i.e., an ‘infinite-length vector’) is $\\left(\\frac{1}{\\sqrt{1}}, \\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{3}}, \\dots\\right)$ because its sum-of-squares decays too slowly as the number of terms increases. A sequence that is in $\\ell ^2$ is $\\left(\\frac{1}{1}, \\frac{1}{2}, \\frac{1}{3}, \\dots\\right)$.\n(Separable) Hilbert Spaces are Isomorphic Isomorphisms are maps from one type of mathematical object to another that preserve its structure. All (separable) infinite-dimensional Hilbert spaces are isomorphic to the $\\ell^2$ space , which is a fancy way of saying that we can do the following: We first construct a countable orthonormal basis for $\\mathcal X$ (e.g., using the Gram-Schmidt process and perhaps Zorn’s lemma ), denoted as $(e_i)_{i=1}^{\\infty}$. Then, we define an isometric isomorphism (a distance-preserving, structure-preserving mapping) from $\\mathcal X$ to $\\ell^2$, as follows:\n\\[T: \\mathcal X \\rightarrow \\ell^2\\] \\[T(x) = (\\langle e_i,x \\rangle_{\\mathcal X})_{i=1}^{\\infty} \\] which is the sequence of coefficients of $x$ along each basis vector. Note that $T$ is basis-dependent, we could pick a different basis and get a different $T$. Since $T$ is an isomorphism (i.e., does not ‘destroy’ information during the mapping), we may hope to be able to go back from $\\ell^2$ to $\\mathcal X$:\n\\[T^*: \\ell^2 \\rightarrow \\mathcal X\\] \\[T^{*}\\left((c_i)_{i=1}^{\\infty}\\right) = \\sum_{i=1}^{\\infty} c_i e_i \\] Here, $T^{*}$ is called the adjoint of $T$; it is an operator that satisfies\n\\[\\langle y,T(x)\\rangle _{\\ell^2} = \\langle T^*(y),x\\rangle _{\\mathcal X}\\]\nThe map $T({}\\cdot{})$ is necessarily linear , and it can be shown that $T^*$ is the inverse of $T$ (i.e., $T^\\ast = T^{-1}$, something which is not true for general linear transformations!). The mapping $T({}\\cdot{})$ can be represented via a matrix, although this matrix has infinitely many rows and columns.\nUsing a similar reasoning as above in the finite-dimensional case, we see that all (separable) complex Hilbert spaces with dimension $N$ are isomorphic to the $(\\mathbb C^N, \\lVert{}\\cdot{}\\rVert_2)$ space. The condition that $T^*=T^{-1}$ might remind you of unitary matrices ($U^\\dagger = U^{-1}$, where $U^\\dagger$ is the conjugate transpose of $U$), which are exactly the distance-preserving, structure-preserving matrices in $\\mathbb C^N$. When we’re working with real Hilbert spaces we replace $\\mathbb C^N$ with $\\mathbb R^N$ and ‘unitary’ with ‘orthogonal’. Recall that $Q^\\intercal = Q^{-1}$ for an orthogonal matrix $Q$. Orthogonal matrices are an isometry (distance-preserving) because $\\lVert Qx\\rVert_2 = \\lVert x \\rVert_2$, and they are an isomorphism (structure-preserving) because $\\langle Qx, Qy \\rangle =\\langle x, Q^\\intercal Qy \\rangle = \\langle x, y\\rangle$. Note that isomorphisms also preserve the angles between vectors.\nThe $L^p$ Space of Functions Let’s move onwards to function spaces. The space $L^1(\\mathbb R)$ is the space of absolutely integrable functions. And element $f\\in L^1(\\mathbb R)$ is a function of the form $f:\\mathbb R\\rightarrow \\mathbb C$ and satisfies\n$$ \\| f\\|_{L^1} =\\int_{\\mathbb R} | f(x)| dx \u003c \\infty.$$It is clear how to add and (pointwise) multiply functions, so $L^1(\\mathbb R)$ is indeed a vector space. The space $L^2(\\mathbb R)$ consists of functions which are square-integrable:\n$$ \\| f\\|_{L^2} =\\left(\\int_{\\mathbb R} | f(x)|^2dx\\right)^{1/2} \u003c \\infty$$and is a Hilbert space because it has the following inner product + norm combination:\n$$ \\begin{align} \\langle f, g \\rangle_{L^2} \u0026= \\int_{\\mathbb R} f(x) \\overline{g(x)} dx\\\\ \\| f\\|_{L^2} \u0026= \\sqrt{ \\langle f, f \\rangle_{L^2}}. \\end{align}$$Can we use the above as an inner product for $L^1$ as well? It turns out that we can’t, because even if $f$ is in $L^1$, the integral of $f(x)\\overline{f(x)}$ can be unbounded if $f$ is not also in $L^2$.\nObserve that we always require some sort of 'boundedness of norm' when defining Hilbert spaces... it is related to the requirement of completeness of the space, which we have conveniently glossed over in this article. The norms on $\\ell^p$ and $L^p$ spaces are natural extensions of the $p$-norms for finite-dimensional vector spaces, and as expected, we have an inner product only when $p=2$. The $L^p(\\mathbb R)$ space can be thought of as a ‘refinement’ of the domain of the $\\ell^p$ space1, where the index set $\\lbrace 1, 2, \\dots, \\infty\\rbrace$ (which was countable) of $\\ell^p$ is replaced with $\\mathbb R$ (which is uncountable) in $L^p$. So even though these might seem like completely different concepts thrown together, they are closely related and inherit much of each other’s properties!\nBut since $L^2$ and $\\ell^2$ are supposed to be isomorphic, this suggests that we can go from $L^2$ to $\\ell^2$ (and back) using a linear map. The fact that we can represent an arbitrary function on a continuous domain using a sequence of numbers is remarkable.\nFourier Transforms This section is for people who might have encountered the Fourier transform before, and want to see the Hilbert space interpretation of it. Consider a function $f\\in L^2([0,1])$, such that $f(t)$ represents the amplitude of a signal at time $t$. The sinusoid is one such signal: $f(t)=\\sin (t)$. An orthogonal basis for $L^2([0, 1])$ is $(e_k)_{k\\in \\mathbb Z}$, where\n$$e_k(t)=\\frac{1}{\\sqrt{2 \\pi}}e^{2 \\pi i k{t}}.$$Here, $\\mathbb Z$ are the integers, which is still a countable set because we can count them as $(0, 1, -1, 2, -2, \\dots)$. In this case, our isomorphism $T$ from $L^2([0,1])$ to $\\ell^2$ is given by:\n$$\\begin{align} T(f) \u0026= \\left(\\langle f, e_k \\rangle \\right)_{k\\in \\mathbb Z}\\\\ \u0026= \\left( \\frac{1}{\\sqrt{2\\pi}}\\int_{0}^1 f(t)e^{-2\\pi i kt} dt\\right)_{k\\in \\mathbb Z} \\end{align}$$These are exactly the Fourier coefficients (up to a constant factor, depending on how you define them)! Each coefficient tells you how much of a certain frequency is present in a signal. The way we have defined them (with proper normalization of the basis vectors) ensures that the Fourier transform $T$ is an isometric isomorphism. In fact, the observation that\n$$\\langle f, g\\rangle_{L^2([0,1])} = \\langle T(f), T(g)\\rangle_{\\ell^2}$$has a special name in the signal processing community: it’s called Parseval’s (or Plancheral’s) theorem. We can also discard some of the Fourier coefficients to compress (or de-noise) a signal by ignoring its weak (or bothersome) frequencies – be it an audio signal or an image. Such a truncation of the sequence is a special case of the projection operation in Hilbert spaces, so it’s the best approximation in terms of the $L^2$ norm of the approximation error.\nOne of the motivations for defining the map $T$ is that we can now represent objects in an arbitrary Hilbert space using a (countable) set of numbers (in $\\ell^2$). Aside from being a powerful theoretical tool, it lets us store and manipulate these objects on computers efficiently, as evidenced by the example of the Fourier transform.\nAll that said, the reason I love typing out posts like these is because it’s so gratifying to see all of these different mathematical objects be unified under a single concept. The interplay between vectors, sequences, and functions is something that was never taught or emphasized to me in school. All throughout college, my instructors usually pulled the Fourier transform out of their hat, just to use it for 2 lectures and then put it back in before I ever figured out what it was. Maybe I’m just a slow learner, so it’s a good thing I have (one would hope) a long life ahead of me to keep learning!\nWe could also view it as a net . ↩︎\n",
  "wordCount" : "1898",
  "inLanguage": "en",
  "datePublished": "2023-04-21T12:09:09-04:00",
  "dateModified": "2023-04-21T12:09:09-04:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://shirazkn.github.io/posts/hilbert-spaces/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Shiraz",
    "logo": {
      "@type": "ImageObject",
      "url": "https://shirazkn.github.io/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://shirazkn.github.io/" accesskey="h" title="Shiraz (Alt + H)">Shiraz</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://shirazkn.github.io/archives/" title="archives">
                    <span>archives</span>
                </a>
            </li>
            <li>
                <a href="https://shirazkn.github.io/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li>
            <li>
                <a href="https://shirazkn.github.io/search/" title="search (Alt &#43; /)" accesskey=/>
                    <span>search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Hilbert Spaces
    </h1>
    <div class="post-meta"><span title='2023-04-21 12:09:09 -0400 EDT'>April 21, 2023</span>

</div>
  </header> 
  <div class="post-content"><p>Let $\mathcal X$ be a Hilbert space, which means that it is a vector space that has an <span class=accented>inner product</span> (denoted by $\langle \cdot, \cdot\rangle _\mathcal X$) and that it is <span class=accented>complete</span>, i.e., it doesn&rsquo;t have er&hellip; holes in it. <a href="/posts/norms_metrics" class="accented">
    Recall
</a> that inner product spaces have a rich geometric structure, and so do Hilbert spaces. The Euclidean space $\mathbb R^n$ is an obvious example, where the inner product is just the dot product. Mathematicians sometimes use &lsquo;Hilbert space&rsquo; to refer specifically to infinite-dimensional inner product spaces, but for our purposes, we will let &lsquo;Hilbert space&rsquo; include the finite-dimensional case.</p>
<p>Some interesting Hilbert spaces are given below. Each of these spaces has a corresponding norm, $\lVert x \rVert_{\mathcal X}=\sqrt{\langle x, x\rangle}_{\mathcal X}$, which we call as the norm that is <em>induced</em> by the inner product.</p>
<table>
  <thead>
      <tr>
          <th>Hilbert Space $\mathcal X$</th>
          <th>Inner Product $\langle \cdot, \cdot\rangle _\mathcal X$</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Numbers $a$, $b\in \mathbb R$</td>
          <td>$ab$</td>
      </tr>
      <tr>
          <td>Random Variables $X,Y\in \mathbb R$</td>
          <td>$\mathbb E \left[XY \right]$</td>
      </tr>
      <tr>
          <td>Real Vectors $x$, $y\in \mathbb R^n$</td>
          <td>$\mathbf x^\intercal \mathbf y$</td>
      </tr>
      <tr>
          <td>Complex Vectors $x$, $y\in \mathbb C^n$</td>
          <td>$\mathbf x^\dagger \mathbf y$</td>
      </tr>
      <tr>
          <td>Matrices $\mathbf A$, $\mathbf B\in \mathbb R^{m\times n}$</td>
          <td>$\ \text{Trace}(\mathbf A^{\intercal}\mathbf B)$</td>
      </tr>
      <tr>
          <td>Sequences $(x_i)_{i=1}^{\infty}, (y_i)_{i=1}^{\infty}\in \ell ^2(\mathbb R) \ $</td>
          <td>$\sum_{i=1}^{\infty} x_i y_i$</td>
      </tr>
      <tr>
          <td>Square-Integrable Functions $f,g \in L^2(\mathbb R)$</td>
          <td>$\int_{-\infty}^{\infty}f(x)\overline{g(x)}dx$</td>
      </tr>
  </tbody>
</table>
<p><sub><sub>
Here, $\overline{({}\cdot{})}$ is the conjugate of a complex number (where you replace $i$ with $-i$), $({}\cdot{})^\dagger =\overline{({}\cdot{})}^\intercal $ is called the conjugate transpose of a complex vector.</sub></sub></p>
<h3 id="projections">Projections<a hidden class="anchor" aria-hidden="true" href="#projections">#</a></h3>
<p>A defining feature of Hilbert Spaces is their geometry. Because they have <a href="/posts/norms_metrics" class="accented">
    notions of angles
</a>, we have</p>
$$
0 \leq {|\langle x, y\rangle_{\mathcal X} |} \leq {\|x\|\|y\|}
$$<p>where if the first equality holds we say $x$ and $y$ are <em>orthogonal</em> to each other, and the second equality holds if and only if they are linearly dependent: $x = a y$ for $a \in \mathbb R$ (or $\mathbb C$, when $\mathcal X$ is a complex vector space).</p>
<p>We can define the <em>projection</em> of an element $x\in \mathcal X$ onto a subspace $S\subseteq \mathcal X$:</p>
<p>
\[ \text{P}_S(x) = \mathrm{argmin}_{y\in S}\|x-y\|_{\mathcal X}\]
</p>
<p>where $\lVert v \rVert_{\mathcal X} = \sqrt{\langle v, v\rangle}_{\mathcal X}$ is the induced norm.
A remarkable by-product of these definitions of angles, orthogonality, and projection, is that it is consistent with our Euclidean intuition: $x-\text{P}_S(x)$ is always orthogonal to $S$. A <a href="https://en.wikipedia.org/wiki/Hilbert_projection_theorem" target="_blank" class="accented">
    related theorem
</a> says that $\text P_{\tilde S}(x)$ is well-defined and unique even if $\tilde S \subseteq \mathcal X$ is a closed convex set, although in this case we do not have orthogonality of $x-\text{P}_{\tilde S}(x)$ to the other elements in $\tilde S$.</p>
<div>
<!-- <figure class=invertible style="max-width: 25%;"> -->
<figure class=invertible style="max-width: 100%;">
<img src=/post-images/linear_algebra/projection.png>
</figure>
</div>
<p>As an example, given two &lsquo;vectors&rsquo; $X$ and $Y$ in the Hilbert space of random variables, orthogonality corresponds to $\mathbb E\left[X Y\right] =  0$ and the norm becomes the variance. In this case, orthogonal projection actually gives the least-squares estimator of given a random variable (<a href="https://aditya-sengupta.github.io/notes/eecs126.pdf" target="_blank" class="accented">
    Lec. 22, p. 85
</a>). More generally, a projection can be used to compute the <a href="https://math.stackexchange.com/questions/3000704/orthogonal-projection-on-a-polynomial-space" target="_blank" class="accented">
    best approximation
</a> of an element of a Hilbert space (namely, the point being projected), with the approximation constrained to lie on a subspace (or a closed convex set).</p>
<hr> 
<h3 id="the--space-of-sequences">The $(\mathbb R^N, \lVert{}\cdot{}\rVert_2)$ Space of Sequences<a hidden class="anchor" aria-hidden="true" href="#the--space-of-sequences">#</a></h3>
<p>Given a vector in the Euclidean space $\mathbb R^N$ (equipped with a basis), we can view it as a set of $N$ coefficients.
Each coefficient (a real number) describes the vector&rsquo;s distance along the corresponding basis vector (or &lsquo;axis&rsquo;, if you will).</p>
<!-- Instead of axis, we should say orthonormal basis. -->
<p>Taking a few steps back, let&rsquo;s begin by viewing $\mathbb R^N$ as the set-theoretic product $\mathbb R \times \mathbb  R \times \dots \times \mathbb R$. An element $x$ of this space is a sequence of real numbers,</p>
<p>
\[x = (x_1, x_2, \dots, x_N).\]
</p>
<p>Once we define notions of <em>addition</em> and <em>scalar multiplication</em> for such $N$-coefficient sequences, we are allowed to call $\mathbb R^N$ a vector space. A norm for $\mathbb R^N$ can be defined as $\left(\sum_{i=1}^N |x_i|^2\right)^{1/2}$, which automatically induces a topology (notion of open and closed sets) on $\mathbb R^N$. We can generalize all of this as $N\rightarrow \infty$.</p>
<h3 id="the--space-of-sequences-1">The $\ell^2$ Space of Sequences<a hidden class="anchor" aria-hidden="true" href="#the--space-of-sequences-1">#</a></h3>
<p>$\ell^2(\mathbb R)$ consists of countable sequences of real numbers. &lsquo;Countable&rsquo; here means that we can count them like we can count the natural numbers, but they are infinitely long nonetheless. We denote one such sequence as $(x_i)_{i=1}^{\infty}$.
A sequence is in $\ell^2$ if and only if it is <span class=accented>square-summable</span>, which means</p>
<p>\[
    \sum_{i=1}^{\infty}|x_i|^2 < \infty 
\]</p>
<p>A sequence which is not in $\ell^2$ (i.e., an &lsquo;infinite-length vector&rsquo;) is
$\left(\frac{1}{\sqrt{1}}, \frac{1}{\sqrt{2}}, \frac{1}{\sqrt{3}}, \dots\right)$ because its sum-of-squares decays too slowly as the number of terms increases. A sequence that is in $\ell ^2$ is $\left(\frac{1}{1}, \frac{1}{2}, \frac{1}{3}, \dots\right)$.</p>
<!-- [^aside]: $\ell^p$ spaces (with the $p$-norm defined analogously) can shed some insight into how vector spaces behave in the limit $N\rightarrow \infty$! Perhaps you could [revisit my post](/posts/balls) on norm balls, think of higher dimensional Euclidean spaces as tending towards the $\ell^2$ space. -->
<h3 id="separable-hilbert-spaces-are-isomorphic">(Separable) Hilbert Spaces are Isomorphic<a hidden class="anchor" aria-hidden="true" href="#separable-hilbert-spaces-are-isomorphic">#</a></h3>
<p><span class=accented>Isomorphisms</span> are maps from one type of mathematical object to another that preserve its structure.
<a href="http://mathonline.wikidot.com/separable-hilbert-spaces-are-isometrically-isomorphic-to-2" target="_blank" class="accented">
    All (separable) infinite-dimensional Hilbert spaces are isomorphic to the $\ell^2$ space
</a>, which is a fancy way of saying that we can do the following: We first construct a countable orthonormal basis for $\mathcal X$ (e.g., using the <a href="https://en.wikipedia.org/wiki/Gram%e2%80%93Schmidt_process" target="_blank" class="accented">
    Gram-Schmidt process
</a> and perhaps <a href="https://en.wikipedia.org/wiki/Zorn%27s_lemma" target="_blank" class="accented">
    Zorn&rsquo;s lemma
</a>), denoted as $(e_i)_{i=1}^{\infty}$. Then, we define an isometric isomorphism (a distance-preserving, <a href="/posts/cat_theory_1" class="accented">
    structure-preserving
</a> mapping) from $\mathcal X$ to $\ell^2$, as follows:</p>
<p>
\[T: \mathcal X \rightarrow \ell^2\]
\[T(x) = (\langle e_i,x \rangle_{\mathcal X})_{i=1}^{\infty} \]
</p>
<p>which is the sequence of coefficients of $x$ along each basis vector. Note that $T$ is basis-dependent, we could pick a different basis and get a different $T$.
Since $T$ is an isomorphism (i.e., does not &lsquo;destroy&rsquo; information during the mapping), we may hope to be able to go back from $\ell^2$ to $\mathcal X$:</p>
<p>
\[T^*: \ell^2 \rightarrow \mathcal X\]
\[T^{*}\left((c_i)_{i=1}^{\infty}\right) = \sum_{i=1}^{\infty} c_i e_i \]
</p>
<p>Here, $T^{*}$ is called the <em>adjoint</em> of $T$; it is an operator that satisfies</p>
<p>\[\langle y,T(x)\rangle _{\ell^2} = \langle T^*(y),x\rangle _{\mathcal X}\]</p>
<p>The map $T({}\cdot{})$ <a href="https://proofwiki.org/wiki/Surjection_that_Preserves_Inner_Product_is_Linear" target="_blank" class="accented">
    is necessarily linear
</a>, and it can be shown that <a href="https://proofwiki.org/wiki/Linear_Transformation_is_Isomorphism_iff_Inverse_Equals_Adjoint" target="_blank" class="accented">
    $T^*$ is the inverse of $T$
</a> (i.e., $T^\ast = T^{-1}$, something which is not true for general linear transformations!). The mapping $T({}\cdot{})$ can be represented via a matrix, although this matrix has infinitely many rows and columns.</p>
<p>Using a similar reasoning as above in the finite-dimensional case, we see that all (separable) complex Hilbert spaces with dimension $N$ are isomorphic to the $(\mathbb C^N, \lVert{}\cdot{}\rVert_2)$ space.
The condition that $T^*=T^{-1}$ might remind you of <a href="https://en.wikipedia.org/wiki/Unitary_matrix" target="_blank" class="accented">
    unitary matrices
</a> ($U^\dagger = U^{-1}$, where $U^\dagger$ is the conjugate transpose of $U$), which are exactly the distance-preserving, structure-preserving matrices in $\mathbb C^N$. When we&rsquo;re working with real Hilbert spaces we replace $\mathbb C^N$ with $\mathbb R^N$ and &lsquo;unitary&rsquo; with &lsquo;orthogonal&rsquo;. Recall that $Q^\intercal = Q^{-1}$ for an orthogonal matrix $Q$. Orthogonal matrices are an isometry (distance-preserving) because $\lVert Qx\rVert_2 = \lVert x \rVert_2$, and they are an isomorphism (structure-preserving) because $\langle Qx, Qy \rangle =\langle x, Q^\intercal Qy \rangle = \langle x, y\rangle$. Note that isomorphisms also preserve the angles between vectors.</p>
<!-- Thus, we always have a unitary matrix (or a [unitary operator](https://en.wikipedia.org/wiki/Unitary_operator) in the infinite-dimensional case) which takes us from one Hilbert space to another of the same dimension, in a distance-preserving, structure-preserving manner. -->
<hr> 
<h3 id="the--space-of-functions">The $L^p$ Space of Functions<a hidden class="anchor" aria-hidden="true" href="#the--space-of-functions">#</a></h3>
<p>Let&rsquo;s move onwards to function spaces.
The space $L^1(\mathbb R)$ is the space of <span class=accented>absolutely integrable</span> functions. And element $f\in L^1(\mathbb R)$ is a function of the form $f:\mathbb R\rightarrow \mathbb C$ and satisfies</p>
$$ \| f\|_{L^1} =\int_{\mathbb R} | f(x)| dx < \infty.$$<p>It is clear how to add and (pointwise) multiply functions, so $L^1(\mathbb R)$ is indeed a vector space. The space $L^2(\mathbb R)$ consists of functions which are <span class=accented>square-integrable</span>:</p>
$$ \| f\|_{L^2} =\left(\int_{\mathbb R} | f(x)|^2dx\right)^{1/2} < \infty$$<p>and is a Hilbert space because it has the following inner product + norm combination:</p>
$$ 
\begin{align}
\langle f, g \rangle_{L^2} &= \int_{\mathbb R} f(x) \overline{g(x)} dx\\
 \| f\|_{L^2} &= \sqrt{ \langle f, f \rangle_{L^2}}.
\end{align}$$<p>Can we use the above as an inner product for $L^1$ as well? It turns out that we can&rsquo;t, because even if $f$ is in $L^1$, the integral of $f(x)\overline{f(x)}$ can be unbounded if $f$ is not also in $L^2$.</p>
<!-- Other $L^p$ spaces are defined analogously. -->
<!-- This would violate the Cauchy-Schwarz inequality for any valid inner product, $| \langle x, y\rangle| \leq \lVert x \rVert \lVert y \rVert$. -->
<aside class=aside-center>
Observe that we always require some sort of 'boundedness of norm' when defining Hilbert spaces... it is related to the requirement of <i>completeness</i> of the space, which we have conveniently glossed over in this article. 
</aside>
<p>The norms on $\ell^p$ and $L^p$ spaces are natural extensions of the <a href="/posts/norms_metrics" class="accented">
    $p$-norms
</a> for finite-dimensional vector spaces, and as expected, we have an inner product only when $p=2$. The $L^p(\mathbb R)$ space can be thought of as a &lsquo;refinement&rsquo; of the domain of the $\ell^p$ space<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>, where the index set $\lbrace 1, 2, \dots, \infty\rbrace$ (which was countable) of $\ell^p$ is replaced with $\mathbb R$ (which is uncountable) in $L^p$. So even though these might seem like completely different concepts thrown together, they are <a href="https://en.wikipedia.org/wiki/Lp_space#Special_cases" target="_blank" class="accented">
    closely related
</a> and inherit much of each other&rsquo;s properties!</p>
<div>
<!-- <figure class=invertible style="max-width: 25%;"> -->
<figure class=invertible style="max-width: 100%;">
<img src=/post-images/linear_algebra/hilbert_spaces.png>
</figure>
</div>
<p>But since $L^2$ and $\ell^2$ are supposed to be isomorphic, this suggests that we can go from $L^2$ to $\ell^2$ (and back) using a linear map. The fact that we can represent an arbitrary function on a continuous domain using a sequence of numbers is remarkable.</p>
<h4 id="fourier-transforms"><a href="https://en.m.wikipedia.org/wiki/Hilbert_space#Fourier_analysis" target="_blank" class="accented">
    Fourier Transforms
</a></h4>
<p>This section is for people who might have encountered the Fourier transform before, and want to see the Hilbert space interpretation of it. Consider a function $f\in L^2([0,1])$, such that $f(t)$ represents the amplitude of a <em>signal</em> at time $t$. The sinusoid is one such signal: $f(t)=\sin
(t)$.
An orthogonal basis for $L^2([0, 1])$ is $(e_k)_{k\in \mathbb Z}$, where</p>
$$e_k(t)=\frac{1}{\sqrt{2 \pi}}e^{2 \pi i k{t}}.$$<p>Here, $\mathbb Z$ are the integers, which is still a countable set because we can count them as $(0, 1, -1, 2, -2, \dots)$.
In this case, our isomorphism $T$ from $L^2([0,1])$ to $\ell^2$ is given by:</p>
$$\begin{align}
T(f) &= \left(\langle f, e_k \rangle \right)_{k\in \mathbb Z}\\
 &= \left( \frac{1}{\sqrt{2\pi}}\int_{0}^1 f(t)e^{-2\pi i kt} dt\right)_{k\in \mathbb Z}
\end{align}$$<p>These are exactly the Fourier coefficients (up to a constant factor, depending on how you define them)! Each coefficient tells you how much of a certain frequency is present in a signal. The way we have defined them (with proper normalization of the basis vectors) ensures that the Fourier transform $T$ is an isometric isomorphism. In fact, the observation that</p>
$$\langle f, g\rangle_{L^2([0,1])} = \langle T(f), T(g)\rangle_{\ell^2}$$<p>has a special name in the signal processing community: it&rsquo;s called <a href="https://en.wikipedia.org/wiki/Parseval's_theorem" class=accented>Parseval&rsquo;s</a> (or <a href="https://en.wikipedia.org/wiki/Plancherel_theorem" class=accented>Plancheral&rsquo;s</a>) theorem. We can also discard some of the Fourier coefficients to <em><a href="https://www.dspguide.com/ch27/6.htm" target="_blank" class="accented">
    compress
</a></em> (or <em>de-noise</em>) a signal by ignoring its weak (or bothersome) frequencies &ndash; be it an audio signal or an image. Such a truncation of the sequence is a special case of the projection operation in Hilbert spaces, so it&rsquo;s the best approximation in terms of the $L^2$ norm of the approximation error.</p>
<hr> 
<p>One of the motivations for defining the map $T$ is that we can now represent objects in an arbitrary Hilbert space using a (countable) set of numbers (in $\ell^2$). Aside from being a powerful theoretical tool, it lets us store and manipulate these objects on computers efficiently, as evidenced by the example of the Fourier transform.</p>
<p>All that said, the reason I love typing out posts like these is because it&rsquo;s so gratifying to see all of these different mathematical objects be unified under a single concept. The interplay between vectors, sequences, and functions is something that was never taught or emphasized to me in school. All throughout college, my instructors usually pulled the Fourier transform out of their hat, just to use it for 2 lectures and then put it back in before I ever figured out what it was. Maybe I&rsquo;m just a slow learner, so it&rsquo;s a good thing I have (one would hope) a long life ahead of me to keep learning!</p>
<!-- Aha! I'm now beginning to understand some of the things that were kept hidden from me... -->
<!-- https://math.stackexchange.com/questions/2739175/do-we-really-need-to-specify-a-basis-to-describe-a-tuple --><div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>We could also view it as a <em><a href="https://en.wikipedia.org/wiki/Net_%28mathematics%29" target="_blank" class="accented">
    net
</a></em>.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://shirazkn.github.io/tags/linear-algebra/">Linear Algebra</a></li>
    </ul>
  </footer>
<script src="https://giscus.app/client.js"
        data-repo="shirazkn/shirazkn.github.io"
        data-repo-id="R_kgDOI2VbWw"
        data-category="Announcements"
        data-category-id="DIC_kwDOI2VbW84CWJnt"
        data-mapping="title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="noborder_light"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
</article>
    </main>
    
<footer class="footer">
    
    
    
    
    
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><script>

function syncDarkClass() {
    const isDark = document.documentElement.dataset.theme === 'dark';
    document.documentElement.classList.toggle('dark', isDark);
    document.body.classList.toggle('dark', isDark);
}
syncDarkClass();


const themeToggle = document.getElementById('theme-toggle');
if (themeToggle) {
    themeToggle.addEventListener('click', () => {
        setTimeout(syncDarkClass, 0);
    });
}


document.querySelectorAll('.logo a, .post-title').forEach(el => {
    el.innerHTML = el.textContent.trim().split(' ').map(word =>
        `<span class="hover-word">${word.split('').map(char =>
            `<span class="hover-letter">${char}</span>`
        ).join('')}</span>`
    ).join(' ');
});


const isDark = () => document.body.classList.contains('dark');
const hoverColors = isDark()
    ? ['#ff51af', '#ff51af', '#f161ac', '#f161ac', '#db327e', '#db327e', '#3b82f6', '#38bdf8']
    : ['#ff51af', '#ff51af', '#e83a89', '#e83a89', '#f542a1', '#d6306f', '#3b9eff', '#00c2ff'];
document.querySelectorAll('.hover-letter').forEach(letter => {
    letter.addEventListener('mouseenter', () => {
        letter.style.color = hoverColors[Math.floor(Math.random() * hoverColors.length)];
    });
    letter.addEventListener('mouseleave', () => {
        letter.style.color = '';
    });
});


const scanElement = (el) => {
    const letters = el.querySelectorAll('.hover-letter');
    letters.forEach((letter, i) => {
        setTimeout(() => {
            letter.style.transition = 'top 0.05s ease-out, color 0s';
            letter.style.color = hoverColors[Math.floor(Math.random() * hoverColors.length)];
            letter.style.top = '-0.08em';
            setTimeout(() => {
                letter.style.transition = '';
                letter.style.color = '';
                letter.style.top = '';
            }, 100);
        }, i * 50);
    });
};

let lastScannedEl = null;
const triggerRandomScan = () => {
    const logos = Array.from(document.querySelectorAll('.logo a'));
    const titles = Array.from(document.querySelectorAll('.post-title'));
    
    const pickLogo = Math.random() < 0.5 && logos.length > 0;
    let elements = pickLogo ? logos : titles;
    
    if (lastScannedEl && elements.length > 1) {
        elements = elements.filter(el => el !== lastScannedEl);
    }
    if (elements.length > 0) {
        const el = elements[Math.floor(Math.random() * elements.length)];
        lastScannedEl = el;
        scanElement(el);
    }
    
    setTimeout(triggerRandomScan, 4000 + Math.random() * 6000);
};


const isHomePage = document.querySelector('.first-entry.home-info') !== null;


const postCards = document.querySelectorAll('.post-entry');
const isTouchDevice = window.matchMedia('(pointer: coarse)').matches;

if (isTouchDevice && window.isSecureContext && 'DeviceOrientationEvent' in window) {
    
    let gyroBaselineBeta = null;
    let gyroBaselineGamma = null;
    const GYRO_DRIFT_RATE = 0.003;
    let gyroRafId = null;
    let latestBeta = null, latestGamma = null;
    let cardGyroPermissionRequested = false;

    function handleCardOrientation(event) {
        if (event.beta === null || event.gamma === null) return;

        
        const orientation = screen.orientation?.angle ?? window.orientation ?? 0;
        let beta, gamma;

        if (orientation === 90) {
            beta = event.gamma;
            gamma = -event.beta;
        } else if (orientation === -90 || orientation === 270) {
            beta = -event.gamma;
            gamma = event.beta;
        } else if (orientation === 180) {
            beta = -event.beta;
            gamma = -event.gamma;
        } else {
            beta = event.beta;
            gamma = event.gamma;
        }

        latestBeta = beta;
        latestGamma = gamma;

        if (!gyroRafId) {
            gyroRafId = requestAnimationFrame(() => {
                
                if (gyroBaselineBeta === null) {
                    gyroBaselineBeta = latestBeta;
                    gyroBaselineGamma = latestGamma;
                }

                
                gyroBaselineBeta += (latestBeta - gyroBaselineBeta) * GYRO_DRIFT_RATE;
                gyroBaselineGamma += (latestGamma - gyroBaselineGamma) * GYRO_DRIFT_RATE;

                
                let relativeBeta = latestBeta - gyroBaselineBeta;
                let relativeGamma = latestGamma - gyroBaselineGamma;

                
                if (Math.abs(relativeBeta) > 40 || Math.abs(relativeGamma) > 40) {
                    gyroBaselineBeta = latestBeta;
                    gyroBaselineGamma = latestGamma;
                    relativeBeta = 0;
                    relativeGamma = 0;
                }

                
                const rotateY = Math.max(-8, Math.min(8, relativeGamma * 0.8));
                const rotateX = Math.max(-8, Math.min(8, relativeBeta * -0.8));

                postCards.forEach(card => {
                    card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(1.003)`;
                });
                gyroRafId = null;
            });
        }
    }

    function enableCardGyroscope() {
        window.addEventListener('deviceorientation', handleCardOrientation, { passive: true });
    }

    
    if (typeof DeviceOrientationEvent.requestPermission === 'function') {
        
        enableCardGyroscope();

        
        const requestPermission = () => {
            if (cardGyroPermissionRequested) return;
            cardGyroPermissionRequested = true;

            DeviceOrientationEvent.requestPermission()
                .then(state => {
                    if (state === 'granted') {
                        enableCardGyroscope();
                    }
                })
                .catch(() => {
                    cardGyroPermissionRequested = false;
                });
        };
        document.addEventListener('touchstart', requestPermission, { once: true, passive: true });
        document.addEventListener('touchend', requestPermission, { once: true, passive: true });
        document.addEventListener('click', requestPermission, { once: true, passive: true });
    } else {
        
        enableCardGyroscope();
    }
} else {
    
    postCards.forEach(card => {
        let rafId = null;
        let mouseX = 0, mouseY = 0;

        card.addEventListener('mousemove', (e) => {
            const rect = card.getBoundingClientRect();
            mouseX = e.clientX - rect.left;
            mouseY = e.clientY - rect.top;

            if (!rafId) {
                rafId = requestAnimationFrame(() => {
                    const centerX = rect.width / 2;
                    const centerY = rect.height / 2;
                    const rotateX = (mouseY - centerY) / centerY * -0.8;
                    const rotateY = (mouseX - centerX) / centerX * 0.8;
                    const normalizedY = (centerY - mouseY) / centerY;
                    const isDarkMode = document.body.classList.contains('dark');
                    const baseOpacity = isDarkMode ? 0.35 : 0.15;
                    const opacityRange = isDarkMode ? 0.25 : 0.15;
                    const shadowOpacity = Math.max(0, baseOpacity + normalizedY * opacityRange);
                    const blur = isDarkMode ? 1 : 0.5;
                    card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) translateY(-1px) scale(1.004)`;
                    card.style.boxShadow = `0 1px ${blur}px rgba(0, 0, 0, ${shadowOpacity})`;
                    rafId = null;
                });
            }
        });
        card.addEventListener('mouseleave', () => {
            if (rafId) {
                cancelAnimationFrame(rafId);
                rafId = null;
            }
            card.style.transform = '';
            card.style.boxShadow = '';
        });
    });
}

if (isHomePage) {
    
    setTimeout(triggerRandomScan, 3000 + Math.random() * 2000);
} else {
    
    setTimeout(() => {
        const logo = document.querySelector('.logo a');
        if (logo) scanElement(logo);

        setTimeout(() => {
            const titles = Array.from(document.querySelectorAll('.post-title'));
            if (titles.length > 0) {
                scanElement(titles[Math.floor(Math.random() * titles.length)]);
            }
            
            setTimeout(triggerRandomScan, 4000 + Math.random() * 6000);
        }, 400);
    }, 800);
}
</script>
<div class="headerfooter">
    <sub><sup><sub>..</sub></sup></sub>
</div>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            document.documentElement.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            document.documentElement.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
