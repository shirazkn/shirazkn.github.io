<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Norm Balls | Shiraz</title>
<meta name="keywords" content="Linear Algebra, Optimization">
<meta name="description" content="Let&rsquo;s look at the norm balls corresponding to the different p-norms. When p equals 2 this is the usual Euclidean distance. The corresponding ball is what we think of when someone says &lsquo;ball&rsquo;, it is all the points that are within a given distance from the origin.">
<meta name="author" content="">
<link rel="canonical" href="https://shirazkn.github.io/posts/balls/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.e150a9308943c96db7a04da2d3c2cfc65f8f6bdf60a8495e630a39fd37bfaf93.css" integrity="sha256-4VCpMIlDyW23oE2i08LPxl&#43;Pa99gqEleYwo5/Te/r5M=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://shirazkn.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://shirazkn.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://shirazkn.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://shirazkn.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://shirazkn.github.io/favicon.ico">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://shirazkn.github.io/posts/balls/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><script>
(function() {
    var pref = localStorage.getItem("pref-theme");
    if (pref === "dark" || (!pref && window.matchMedia("(prefers-color-scheme: dark)").matches)) {
        document.documentElement.classList.add("dark");
    }
})();
</script>

<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      packages: {'[+]': ['mathtools', 'amscd']},
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['\\(', '\\)'], ['$', '$']]  
    },
    loader:{
      load: ['ui/safe', '[tex]/mathtools', '[tex]/amscd']
    },
  };
</script>

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IM+Fell+DW+Pica">

<meta property="og:url" content="https://shirazkn.github.io/posts/balls/">
  <meta property="og:site_name" content="Shiraz">
  <meta property="og:title" content="Norm Balls">
  <meta property="og:description" content="Let’s look at the norm balls corresponding to the different p-norms. When p equals 2 this is the usual Euclidean distance. The corresponding ball is what we think of when someone says ‘ball’, it is all the points that are within a given distance from the origin.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-04-18T21:32:10-04:00">
    <meta property="article:modified_time" content="2023-04-18T21:32:10-04:00">
    <meta property="article:tag" content="Linear Algebra">
    <meta property="article:tag" content="Optimization">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Norm Balls">
<meta name="twitter:description" content="Let&rsquo;s look at the norm balls corresponding to the different p-norms. When p equals 2 this is the usual Euclidean distance. The corresponding ball is what we think of when someone says &lsquo;ball&rsquo;, it is all the points that are within a given distance from the origin.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://shirazkn.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Norm Balls",
      "item": "https://shirazkn.github.io/posts/balls/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Norm Balls",
  "name": "Norm Balls",
  "description": "Let\u0026rsquo;s look at the norm balls corresponding to the different p-norms. When p equals 2 this is the usual Euclidean distance. The corresponding ball is what we think of when someone says \u0026lsquo;ball\u0026rsquo;, it is all the points that are within a given distance from the origin.",
  "keywords": [
    "Linear Algebra", "Optimization"
  ],
  "articleBody": "Let’s look at the norm balls corresponding to the different $p$-norms in $\\mathbb R^n$, where $n$ is the dimension of the space. For a vector $v\\in \\mathbb R^n$, the $p$-norm is\n\\[ \\|x\\|_p \\coloneqq \\left(\\sum_i |x_i|^p\\right)^{\\frac{1}{p}} \\] When $p=2$ this is the usual Euclidean distance. The corresponding ball is what we think of when someone says ball, it is all the points that are within a given distance from the origin. More generally, the ball of ‘radius’ $r$ corresponding to a norm $\\lVert{}\\cdot{}\\rVert$ is\n\\[\\lbrace x\\ |\\ x\\in\\mathbb R^n, \\|x\\|\\leq r\\rbrace\\] Let’s call the ball corresponding to $\\lVert{}\\cdot{}\\rVert_p$ as the $p$-ball. If $r=1$, we will call it a unit ball. This website shows the unit balls corresponding to other $p$-norms. Here is my artistic illustration of the same:\nThe figure may indicate that $\\lVert{}\\cdot{}\\rVert_p$ gets bigger as $p$ increases, but it’s the other way around:\n\\[\\|x\\|_1 \\geq \\|x\\|_2 \\geq \\dots \\geq \\|x\\|_\\infty\\]\nbecause you need to go further from the origin to get to the $\\infty$ ball. This is similar to how a car with a poorer mileage would need to expend more fuel to get to the same point. So the balls get bigger, but the ‘mileage’ gets smaller.\nIf $p\u003c1$, then the corresponding “$p$-norm” is not actually a norm, as it is guaranteed to violate the conditions which we usually place on a norm. What feature do we see appearing in the $p$-balls, when $p\u003c1$? They answer is that they curve inwards (are non-convex). In particular, the $0$-ball is quite bizarre, it is exactly the axes! ( Recall that the “$0$-norm” counts the number of non-zero elements in a vector, which is $1$ for each point on the axes). Let’s not talk about the $0$-ball for now.\nThe $2$-Ball When $n=2$ the $2$-ball is a circle, and when $n=3$ the $2$-ball is a sphere. What’s less obvious is the case of $n=1$, in which case each of the $p$-norm unit balls is just the line segment from $-1$ to $1$.\nWe may or may not remember from high-school physics that spheres (i.e., $2$-balls) minimize the ratio of the surface area to volume of a shape. It is why bubbles take spherical shapes, in order to minimize their potential energy. A defining feature of the $2$-ball is that it has continuous rotational symmetry – we can rotate the $2$-ball without changing its shape, something we cannot do for any of the other $p$-balls.\nThe $\\infty$-Ball Recall that the $\\infty$-norm is evaluated by taking the limit $p\\rightarrow \\infty$ in the definition of the $p$-norm, giving\n\\[ \\|x\\|_\\infty=\\max\\left\\lbrace|x_1|, |x_2|, \\dots, |x_n|\\right\\rbrace \\] The $\\lVert{}\\cdot{}\\rVert_\\infty$ unit ball is always a cube in each dimension, it can be treated as the definition of a unit cube. As such, it has $2n$ faces in dimension $n$. This is because\n\\[ \\max\\left\\lbrace|x_1|, |x_2|, \\dots, |x_n|\\right\\rbrace \\leq 1 \\] \\[ \\Updownarrow \\] \\[ |x_1|\\leq 1\\quad \\text{and}\\quad |x_2|\\leq 1\\quad \\text{and}\\quad \\dots\\quad |x_n|\\leq 1 \\] \\[ \\Updownarrow \\] \\[ x_1\\leq 1\\quad \\text{and}\\quad -x_1\\leq 1\\quad \\dots\\quad x_n\\leq 1 \\quad \\text{and}\\quad -x_n\\leq 1 \\] which gives us $2n$ linear constraints, with each linear constraint adding a face.\nThe $1$-Ball The $1$-Ball in $2$ dimensions seems like a rotated square, or a diamond, and it appears like this should generalize. Let’s count its faces.\n\\[ |x_1| + |x_2| + \\dots + |x_n| \\leq 1 \\quad \\Leftrightarrow \\quad \\pm x_1 \\pm x_2 \\pm \\dots \\pm x_n \\leq 1 \\] where each ‘$\\pm$’ indicates that we can choose either sign to obtain a different inequality. The total number of linear inequalities that we can construct is $2^n$. So $1$-balls have many, many more faces than $\\infty$-balls in higher dimensions!\nThis observation has consequences in the field of optimization; some poor bloke here is trying to check whether a given vector $x$ lies inside the $1$-ball. They write this out as a system of linear inequalities, only to realize that it would take an exponentially large number of linear inequalities to do this.\nEquivalence of Norms Given any two numbers $p_1$ and $p_2$ between 0 and $\\infty$, with $1\\leq p_1,p_2\\leq \\infty$, we can place $p_1$-balls inside and outside a given $p_2$-ball so that they touch. Two examples of this are as follows:\nThis is what is meant when we say that the $p$-norms are equivalent. Vectors are big (or small) in one norm if and only if they’re big (or small) in the other. ‘Big’ and ‘small’ are used very subjectively here.\nHigher Dimensions We can use everything we just introduced to show interesting quirks of high-dimensional geometry. While this is an entertaining discussion in its own right, it has important consequences in fields like deep learning and probability theory.\nThe Construction: Consider placing a cube of side length $2$ centred at the origin, as well as a green cube with side length $4$. Then place a sphere at each of the corners of the (inner) cube so that they touch each other, as follows:\nwhere by ‘sphere’ and ‘cube’ we really mean hypersphere and hypercube, which are their corresponding higher dimensional analogues. Finally, we try to squeeze in a new orange sphere at the centre. The entire configuration fits snugly inside the bigger green cube, and the maroon/pink spheres are in some sense ’tightly packed’ inside the green cube. The figure above is for dimension $2$.\nSome Observations: Let’s say we are in some higher dimension, $n$. If this feels like unfamiliar territory, we can think of these as $2$-balls and $\\infty$-balls, so we have all the machinery needed to be able to think about these objects at some capacity. For example, we know the following:\nFrom the origin, we can travel exactly $1$ unit along any axis to reach the inner cube The radii of the spheres at the corners is $1$ The corners of the inner cube are $\\sqrt n$ away from the origin, in terms of the Euclidean distance (or by a repeated application of the Pythagoras theorem ) When $n\\gg1$, the corners of the inner cube are extremely ($\\sqrt n$) far from the origin, whereas its faces are still $1$ unit away. People often phrase this as “higher dimensional cubes are spiky”. Here are some weirder facts:\nThe spheres at the corners still have radius $1$ There are $2^n$ spheres at the corners, because there are $2^n$ corners for the cube The orange sphere has a radius of $\\sqrt n -1$ Thus, in $1$ dimension, the orange sphere has radius $0$. In $3$ dimensions it has radius $\\sqrt 3 -1$. In $4$ dimensions it has radius… $1$? It’s the same size as the spheres at the corners… and it touches the faces of the inner cube…\nIn the $10^{th}$ dimension, the sphere in the middle sticks out of the outer (green) cube! Because the corners of the cube have moved far from the origin, so have the unit spheres we placed at them, making more room for the orange sphere to expand with the dimension.\nGoing Inwards Let’s take now the following construction, where we inscribe a purple sphere inside the inner cube. These are precisely the unit balls of the $2$ and $\\infty$ norms:\nWe saw that the $\\infty$-ball always touches the $2$-ball from the outside, so even if we turn up the dimension, the sphere better remain contained within the cube. But the corners are still moving away from the origin, so the cube seems to be getting comparatively larger. Let $\\text{Vol}({}\\cdot{})$ denote the volume (given by the Lebesgue measure ) of a set.\n\\[\\frac{\\text{Vol}\\left(\\textit{\\ Unit Sphere in }\\mathbb R^n\\ \\right)}{\\text{Vol}\\left(\\textit{\\ Unit Cube in }\\mathbb R^n\\ \\right)}\\ \\rightarrow\\ 0\\qquad \\text{as}\\ n\\rightarrow \\infty \\] The higher dimensional sphere is insignificantly small in comparison to the cube. Actually, our earlier construction was also saying the same thing. The purple sphere can be thought of as one of the spheres we placed at the corners of the inner cube, each of which vanishes as $n\\rightarrow \\infty$!1\nThere’s a variety of ways of showing this, though it’s less straightforward than the stuff we did so far. My favorite proof of this (or rather, a comparable) result is from example $2.2.5$ of Rick Durett’s Probability Theory, where he shows it using the law of large numbers! The reason it stands out in my memory is not only because of the absurdity of showing a fact of geometry using something so seemingly far removed from geometry, but because he prefaces the result with the sentence, “Our next result is for comic relief.” The probabilistic argument shows that almost all of the volume of the cube is concentrated within some thin shell, somewhere between its center and its corners. I know, it’s bizarre.\nAn Intuition We can reuse my analogy about the ‘mileage’ for norms. In higher dimensions, the $2$-norm has a lot of mileage in the ‘$45^{\\circ}$’ direction, so we don’t need to go that far out to reach its unit ball. The $\\infty$-ball actually has barely any mileage in this direction, because we need to go $\\sqrt{n}$ far to reach its ball. Another useful way to think of this is to consider the sequence of real numbers (which is really what $\\mathbb R^n$ is),\n\\[(1, 1, 1, \\dots, 1)\\] Think about its sum ($1$-norm) vs. its maximum element ($\\infty$-norm), and remember that ‘mileage’ of a norm corresponds inversely to the size of the norm ball.\nThe Curse of Dimensionality A quirk that shows up repeatedly in deep learning in various forms is the so-called curse of dimensionality. It usually refers to one of several things, but one of these is the vanishing of the higher dimensional sphere. Think of each dimension in the preceding discussion as the parameter of a neural network. The ambient space (where the purple sphere lives) is like the parameter space of the neural network; it is the set of all possible combinations of parameters. Searching for the right combination of parameters (the sphere) in the much larger parameter space (the cube) becomes more and more futile as the number of parameters (the dimension) increases.\nOn the other hand, certain quirks of higher dimensional geometry constitute what some researchers call the blessing of dimensionality . Of the different things it can refer to, one of the observations is that as the dimension increases, random sampling from a high-dimensional vector space becomes more and more well-behaved. The sampled vectors are increasingly likely to be orthogonal , and have a somewhat predictable length (due to Durett’s ‘volume concentration’ example). It can be used to facilitate, rather than hinder high-dimensional computational tasks, so long as one knows what to watch out for.\nAt the end of this note the author places spheres at the corners of the $1$-ball instead. I don’t know enough topology to see if the ‘paradox’ that arises in this case can be explained without introducing additional concepts. ↩︎\n",
  "wordCount" : "1800",
  "inLanguage": "en",
  "datePublished": "2023-04-18T21:32:10-04:00",
  "dateModified": "2023-04-18T21:32:10-04:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://shirazkn.github.io/posts/balls/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Shiraz",
    "logo": {
      "@type": "ImageObject",
      "url": "https://shirazkn.github.io/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://shirazkn.github.io/" accesskey="h" title="Shiraz (Alt + H)">Shiraz</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://shirazkn.github.io/archives/" title="archives">
                    <span>archives</span>
                </a>
            </li>
            <li>
                <a href="https://shirazkn.github.io/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li>
            <li>
                <a href="https://shirazkn.github.io/search/" title="search (Alt &#43; /)" accesskey=/>
                    <span>search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Norm Balls
    </h1>
    <div class="post-meta"><span title='2023-04-18 21:32:10 -0400 EDT'>April 18, 2023</span>

</div>
  </header> 
  <div class="post-content"><p>Let&rsquo;s look at the norm balls corresponding to the different $p$-norms in $\mathbb R^n$, where $n$ is the dimension of the space. For a vector $v\in \mathbb R^n$, the $p$-norm is</p>
<p>
\[
    \|x\|_p \coloneqq \left(\sum_i |x_i|^p\right)^{\frac{1}{p}}
\]
</p>
<p>When $p=2$ this is the usual Euclidean distance. The corresponding ball is what we think of when someone says <em>ball</em>, it is all the points that are within a given distance from the origin. More generally, the ball of &lsquo;radius&rsquo; $r$ corresponding to a norm $\lVert{}\cdot{}\rVert$ is</p>
<p>
\[\lbrace x\ |\ x\in\mathbb R^n, \|x\|\leq r\rbrace\]
</p>
<p>Let&rsquo;s call the ball corresponding to $\lVert{}\cdot{}\rVert_p$ as the $p$-ball. If $r=1$, we will call it a unit ball.
<a href="https://mimmackk.github.io/unitball/" target="_blank" class="accented">
    This website
</a> shows the unit balls corresponding to other $p$-norms. Here is my artistic illustration of the same:</p>
<div>
<!-- <figure class=invertible style="max-width: 25%;"> -->
<figure class=invertible style="max-width: 100%;">
<img src=/post-images/linear_algebra/NormBalls.png>
</figure>
</div>
<p>The figure may indicate that $\lVert{}\cdot{}\rVert_p$ gets bigger as $p$ increases, but it&rsquo;s the other way around:</p>
<p>\[\|x\|_1 \geq \|x\|_2 \geq \dots \geq \|x\|_\infty\]</p>
<p>because you need to go <em>further</em> from the origin to get to the $\infty$ ball. This is similar to how a car with a <em>poorer</em> mileage would need to expend <em>more</em> fuel to get to the same point. So the balls get bigger, but the &lsquo;mileage&rsquo; gets smaller.</p>
<p>If $p<1$, then the corresponding &ldquo;$p$-norm&rdquo; is not actually a norm, as it is guaranteed to violate <a href="/posts/norms_metrics" class="accented">
    the conditions
</a> which we usually place on a norm. What feature do we see appearing in the $p$-balls, when $p<1$? They answer is that they curve inwards (are <em>non-convex</em>). In particular, the $0$-ball is quite bizarre, it is exactly the axes! (<a href="/posts/norms_metrics" class="accented">
    Recall
</a> that the &ldquo;$0$-norm&rdquo; counts the number of non-zero elements in a vector, which is $1$ for each point on the axes). Let&rsquo;s not talk about the $0$-ball for now.</p>
<h3 id="the--ball">The $2$-Ball<a hidden class="anchor" aria-hidden="true" href="#the--ball">#</a></h3>
<p>When $n=2$ the $2$-ball is a circle, and when $n=3$ the $2$-ball is a sphere. What&rsquo;s less obvious is the case of $n=1$, in which case each of the $p$-norm unit balls is just the line segment from $-1$ to $1$.</p>
<p>We may or may not remember from high-school physics that spheres (i.e., $2$-balls) minimize the ratio of the surface area to volume of a shape. It is why bubbles take spherical shapes, in order to minimize their potential energy. A defining feature of the $2$-ball is that it has continuous rotational symmetry &ndash; we can rotate the $2$-ball without changing its shape, something we cannot do for any of the other $p$-balls.</p>
<!-- We looked at the $2$-norm in detail in [earlier posts](/posts/leastsquares). Specifically, we observe that we can rotate the $2$-balls without changing its shape, something we cannot do for any of the other $p$-balls. -->
<h3 id="the--ball-1">The $\infty$-Ball<a hidden class="anchor" aria-hidden="true" href="#the--ball-1">#</a></h3>
<p>Recall that the $\infty$-norm is evaluated by taking the limit $p\rightarrow \infty$ in the definition of the $p$-norm, giving</p>
<p>
\[
    \|x\|_\infty=\max\left\lbrace|x_1|, |x_2|, \dots, |x_n|\right\rbrace
    \]
</p>
<p>The $\lVert{}\cdot{}\rVert_\infty$ unit ball is always a cube in each dimension, it can be treated as the definition of a <span class=accented>unit cube</span>.
As such, it has $2n$ faces in dimension $n$. This is because</p>
<p>
\[
  \max\left\lbrace|x_1|, |x_2|, \dots, |x_n|\right\rbrace \leq 1
    \]
    \[
  \Updownarrow
    \]
\[
 |x_1|\leq 1\quad \text{and}\quad |x_2|\leq 1\quad \text{and}\quad \dots\quad |x_n|\leq 1 
 \]
 \[
  \Updownarrow
    \]
\[
 x_1\leq 1\quad \text{and}\quad -x_1\leq 1\quad \dots\quad x_n\leq 1 \quad \text{and}\quad -x_n\leq 1
 \]
</p>
<p>which gives us $2n$ linear constraints, with each linear constraint adding a face.</p>
<h3 id="the--ball-2">The $1$-Ball<a hidden class="anchor" aria-hidden="true" href="#the--ball-2">#</a></h3>
<p>The $1$-Ball in $2$ dimensions seems like a rotated square, or a diamond, and it appears like this should generalize. Let&rsquo;s count its faces.</p>
<p>
\[
|x_1| + |x_2|  + \dots + |x_n| \leq 1
 \quad  \Leftrightarrow \quad
  \pm x_1 \pm x_2  \pm \dots \pm x_n \leq 1
    \]
</p>
<p>where each &lsquo;$\pm$&rsquo; indicates that we can choose either sign to obtain a different inequality. The total number of linear inequalities that we can construct is $2^n$. So $1$-balls have many, many more faces than $\infty$-balls in higher dimensions!</p>
<p>This observation has consequences in the field of <em>optimization</em>; <a href="https://math.stackexchange.com/questions/2287818/writing-the-unit-ell-1-ball-in-mathbbrn-as-the-intersection-of-closed-h" target="_blank" class="accented">
    some poor bloke here
</a> is trying to check whether a given vector $x$ lies inside the $1$-ball. They write this out as a system of linear inequalities,
only to realize that it would take an exponentially large number of linear inequalities to do this.</p>
<!-- The particular face in the positive quadrant of the $1$-ball, with $x_i\geq 0 \forall i$, is called the *probability simplex* -->
<h3 id="equivalence-of-norms">Equivalence of Norms<a hidden class="anchor" aria-hidden="true" href="#equivalence-of-norms">#</a></h3>
<p>Given any two numbers $p_1$ and $p_2$ between 0 and $\infty$, with $1\leq p_1,p_2\leq \infty$, we can <span class=accented>place $p_1$-balls inside and outside a given $p_2$-ball</span> so that they touch.
Two examples of this are as follows:</p>
<div>
<figure class=invertible style="max-width: 80%;">
<img src=/post-images/linear_algebra/equivalence.png>
</figure>
</div>
<p>This is what is meant when we say that the $p$-norms are <em>equivalent</em>. Vectors are big (or small) in one norm if and only if they&rsquo;re big (or small) in the other. &lsquo;Big&rsquo; and &lsquo;small&rsquo; are used very subjectively here.</p>
<h2 id="higher-dimensions">Higher Dimensions<a hidden class="anchor" aria-hidden="true" href="#higher-dimensions">#</a></h2>
<p>We can use everything we just introduced to show interesting quirks of high-dimensional geometry. While this is an entertaining discussion in its own right, it has important consequences in fields like deep learning and probability theory.</p>
<p><strong>The Construction:</strong> Consider placing a cube of side length $2$ centred at the origin, as well as a green cube with side length $4$. Then place a sphere at each of the corners of the (inner) cube so that they touch each other, as follows:</p>
<div>
<figure class=invertible style="max-width: 100%;">
<img src=/post-images/linear_algebra/spheres_on_cube.png>
</figure>
</div>
<p>where by &lsquo;sphere&rsquo; and &lsquo;cube&rsquo; we really mean hypersphere and hypercube, which are their corresponding higher dimensional analogues. Finally, we try to <em>squeeze in</em> a new <span>orange sphere</span> at the centre. The entire configuration fits snugly inside the bigger green cube, and the maroon/pink spheres are in some sense &rsquo;tightly packed&rsquo; inside the green cube. The figure above is for dimension $2$.</p>
<p><strong>Some Observations:</strong>
Let&rsquo;s say we are in some higher dimension, $n$. If this feels like unfamiliar territory, we can think of these as $2$-balls and $\infty$-balls, so we have all the machinery needed to be able to think about these objects at some capacity. For example, we know the following:</p>
<ol>
<li>From the origin, we can travel exactly $1$ unit along any axis to reach the inner cube</li>
<li>The radii of the spheres at the corners is $1$</li>
<li>The corners of the inner cube are $\sqrt n$ away from the origin, in terms of the <a href="/posts/norms_metrics" class="accented">
    Euclidean distance
</a> (or by a repeated application of <a href="/posts/pythagoras" class="accented">
    the Pythagoras theorem
</a>)</li>
</ol>
<p>When $n\gg1$, the corners of the inner cube are extremely ($\sqrt n$) far from the origin, whereas its faces are still $1$ unit away. People often phrase this as
&ldquo;<span class=accented>higher dimensional cubes are spiky</span>&rdquo;. Here are some weirder facts:</p>
<ol start="4">
<li>The spheres at the corners still have radius $1$</li>
<li>There are $2^n$ spheres at the corners, because there are $2^n$ corners for the cube</li>
</ol>
<div>
<figure class=invertible style="max-width: 100%;">
<img src=/post-images/linear_algebra/inner_sphere.png>
</figure>
</div>
<ol start="6">
<li>The orange sphere has a radius of $\sqrt n -1$</li>
</ol>
<p>Thus, in $1$ dimension, the orange sphere has radius $0$. In $3$ dimensions it has radius $\sqrt 3 -1$. In $4$ dimensions it has radius&hellip; $1$? It&rsquo;s the same size as the spheres at the corners&hellip; and it touches the faces of the inner cube&hellip;</p>
<ol start="7">
<li>In the $10^{th}$ dimension, the sphere in the middle sticks out of the outer (green) cube!</li>
</ol>
<p>Because the corners of the cube have moved far from the origin, so have the unit spheres we placed at them, making more room for the orange sphere to expand with the dimension.</p>
<hr>
<h3 id="going-inwards">Going Inwards<a hidden class="anchor" aria-hidden="true" href="#going-inwards">#</a></h3>
<p>Let&rsquo;s take now the following construction, where we inscribe a purple sphere inside the inner cube. These are precisely the unit balls of the $2$ and $\infty$ norms:</p>
<div>
<figure class=invertible style="max-width: 100%;">
<img src=/post-images/linear_algebra/sphere_in_cube.png>
</figure>
</div>
<p>We saw that the $\infty$-ball always touches the $2$-ball from the outside, so even if we turn up the dimension, the sphere better remain contained within the cube. But the corners are still moving away from the origin, so the cube seems to be getting comparatively larger. Let $\text{Vol}({}\cdot{})$ denote the volume (given by the <a href="https://en.wikipedia.org/wiki/Lebesgue_measure" target="_blank" class="accented">
    Lebesgue measure
</a>) of a set.</p>
<p>
\[\frac{\text{Vol}\left(\textit{\ Unit Sphere in }\mathbb R^n\ \right)}{\text{Vol}\left(\textit{\ Unit Cube in }\mathbb R^n\ \right)}\  \rightarrow\  0\qquad \text{as}\ n\rightarrow \infty \]
</p>
<p>The higher dimensional sphere is insignificantly small in comparison to the cube. Actually, our earlier construction was also saying the same thing. The purple sphere can be thought of as one of the spheres we placed at the corners of the inner cube, each of which vanishes as $n\rightarrow \infty$!<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></p>
<p>There&rsquo;s a variety of ways of showing this, though it&rsquo;s less straightforward than the stuff we did so far. My favorite proof of this (or rather, a comparable) result is from example $2.2.5$ of Rick Durett&rsquo;s Probability Theory, where he shows it using the law of large numbers! The reason it stands out in my memory is not only because of the absurdity of showing a fact of geometry using something so seemingly far removed from geometry, but
because he prefaces the result with the sentence, &ldquo;<em>Our next result is for comic relief.</em>&rdquo; The probabilistic argument shows that almost all of the volume of the cube is concentrated within some thin shell, somewhere between its center and its corners. I know, it&rsquo;s bizarre.</p>
<h4 id="an-intuition">An Intuition<a hidden class="anchor" aria-hidden="true" href="#an-intuition">#</a></h4>
<p>We can reuse my analogy about the &lsquo;mileage&rsquo; for norms. In higher dimensions, the $2$-norm has a lot of mileage in the &lsquo;$45^{\circ}$&rsquo; direction, so we don&rsquo;t need to go that far out to reach its unit ball. The $\infty$-ball actually has barely any mileage in this direction, because we need to go $\sqrt{n}$ far to reach its ball. Another useful way to think of this is to consider the sequence of real numbers (which is really what $\mathbb R^n$ is),</p>
<p>
\[(1, 1, 1, \dots, 1)\]
</p>
<p>Think about its sum ($1$-norm) vs. its maximum element ($\infty$-norm), and remember that &lsquo;mileage&rsquo; of a norm corresponds inversely to the size of the norm ball.</p>
<hr>
<h3 id="the-curse-of-dimensionality">The Curse of Dimensionality<a hidden class="anchor" aria-hidden="true" href="#the-curse-of-dimensionality">#</a></h3>
<p>A quirk that shows up repeatedly in deep learning in various forms is the so-called <span class=accented>curse of dimensionality</span>. It usually refers to one of several things, but one of these is the vanishing of the higher dimensional sphere. Think of each dimension in the preceding discussion as the <em>parameter</em> of a neural network. The ambient space (where the purple sphere lives) is like the <em>parameter space</em> of the neural network; it is the set of all possible combinations of parameters. Searching for the right combination of parameters (the sphere) in the much larger parameter space (the cube) becomes more and more futile as the number of parameters (the dimension) increases.</p>
<p>On the other hand, certain quirks of higher dimensional geometry constitute what some researchers call the <a href="https://citeseerx.ist.psu.edu/doc/10.1.1.329.3392" target="_blank" class="accented">
    blessing of dimensionality
</a>. Of the different things it can refer to, one of the observations is that as the dimension increases, random sampling from a high-dimensional vector space becomes more and more well-behaved. The sampled vectors <a href="https://drscotthawley.github.io/blog/2022/01/24/MultiDim-DotProducts.html" target="_blank" class="accented">
    are increasingly likely to be orthogonal
</a>, and have a somewhat predictable length (due to Durett&rsquo;s &lsquo;volume concentration&rsquo; example). It can be used to facilitate, rather than hinder high-dimensional computational tasks, so long as one knows what to watch out for.</p>
<!-- The 'paradox' in this case is that it violates the Heine-Borel and Weierstrass' theorems which hold in finite-dimensional case. --><div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>At the end of <a href="https://faculty.etsu.edu/gardnerr/Func/notes/HWG-5-4.pdf" target="_blank" class="accented">
    this note
</a> the author places spheres at the corners of the $1$-ball instead. I don&rsquo;t know enough topology to see if the &lsquo;paradox&rsquo; that arises in this case can be explained without introducing additional concepts.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://shirazkn.github.io/tags/linear-algebra/">Linear Algebra</a></li>
      <li><a href="https://shirazkn.github.io/tags/optimization/">Optimization</a></li>
    </ul>
  </footer>
<script src="https://giscus.app/client.js"
        data-repo="shirazkn/shirazkn.github.io"
        data-repo-id="R_kgDOI2VbWw"
        data-category="Announcements"
        data-category-id="DIC_kwDOI2VbW84CWJnt"
        data-mapping="title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="noborder_light"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
</article>
    </main>
    
<footer class="footer">
    
    
    
    
    
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><script>

function syncDarkClass() {
    const isDark = document.documentElement.dataset.theme === 'dark';
    document.documentElement.classList.toggle('dark', isDark);
    document.body.classList.toggle('dark', isDark);
}
syncDarkClass();


const themeToggle = document.getElementById('theme-toggle');
if (themeToggle) {
    themeToggle.addEventListener('click', () => {
        setTimeout(syncDarkClass, 0);
    });
}


document.querySelectorAll('.logo a, .post-title').forEach(el => {
    el.innerHTML = el.textContent.trim().split(' ').map(word =>
        `<span class="hover-word">${word.split('').map(char =>
            `<span class="hover-letter">${char}</span>`
        ).join('')}</span>`
    ).join(' ');
});


const isDark = () => document.body.classList.contains('dark');
const hoverColors = isDark()
    ? ['#ff51af', '#ff51af', '#f161ac', '#f161ac', '#db327e', '#db327e', '#3b82f6', '#38bdf8']
    : ['#ff51af', '#ff51af', '#e83a89', '#e83a89', '#f542a1', '#d6306f', '#3b9eff', '#00c2ff'];
document.querySelectorAll('.hover-letter').forEach(letter => {
    letter.addEventListener('mouseenter', () => {
        letter.style.color = hoverColors[Math.floor(Math.random() * hoverColors.length)];
    });
    letter.addEventListener('mouseleave', () => {
        letter.style.color = '';
    });
});


const scanElement = (el) => {
    const letters = el.querySelectorAll('.hover-letter');
    letters.forEach((letter, i) => {
        setTimeout(() => {
            letter.style.transition = 'top 0.05s ease-out, color 0s';
            letter.style.color = hoverColors[Math.floor(Math.random() * hoverColors.length)];
            letter.style.top = '-0.08em';
            setTimeout(() => {
                letter.style.transition = '';
                letter.style.color = '';
                letter.style.top = '';
            }, 100);
        }, i * 50);
    });
};

let lastScannedEl = null;
const triggerRandomScan = () => {
    const logos = Array.from(document.querySelectorAll('.logo a'));
    const titles = Array.from(document.querySelectorAll('.post-title'));
    
    const pickLogo = Math.random() < 0.5 && logos.length > 0;
    let elements = pickLogo ? logos : titles;
    
    if (lastScannedEl && elements.length > 1) {
        elements = elements.filter(el => el !== lastScannedEl);
    }
    if (elements.length > 0) {
        const el = elements[Math.floor(Math.random() * elements.length)];
        lastScannedEl = el;
        scanElement(el);
    }
    
    setTimeout(triggerRandomScan, 4000 + Math.random() * 6000);
};


const isHomePage = document.querySelector('.first-entry.home-info') !== null;


const postCards = document.querySelectorAll('.post-entry');
const isTouchDevice = window.matchMedia('(pointer: coarse)').matches;

if (isTouchDevice && window.isSecureContext && 'DeviceOrientationEvent' in window) {
    
    
    let gyroBaselineBeta = null;
    let gyroBaselineGamma = null;
    const GYRO_DRIFT_RATE = 0.012;
    let gyroRafId = null;
    let latestBeta = null, latestGamma = null;
    let cardGyroPermissionRequested = false;

    
    let currentRotateX = 0, currentRotateY = 0;

    
    let cardFocusValues = new Array(postCards.length).fill(0);
    let scrollRafId = null;

    function updateCardFocus() {
        
        if (scrollRafId) return;
        scrollRafId = requestAnimationFrame(() => {
            const viewportHeight = window.innerHeight;
            const scrollY = window.scrollY;
            const docHeight = document.documentElement.scrollHeight;
            const maxScroll = docHeight - viewportHeight;

            
            const firstCardRect = postCards[0]?.getBoundingClientRect();
            const firstCardCenter = firstCardRect ? firstCardRect.top + firstCardRect.height / 2 : viewportHeight * 0.3;

            
            const scrollProgress = maxScroll > 0 ? scrollY / maxScroll : 0;
            const targetFocusPoint = viewportHeight * 0.7;
            const viewportFocusPoint = firstCardCenter + scrollProgress * (targetFocusPoint - firstCardCenter);

            
            const plateauRadius = viewportHeight * 0.10; 
            const falloffDistance = viewportHeight * 0.18; 

            postCards.forEach((card, i) => {
                const rect = card.getBoundingClientRect();
                const cardCenter = rect.top + rect.height / 2;

                
                const distance = Math.abs(cardCenter - viewportFocusPoint);

                let focus;
                if (distance <= plateauRadius) {
                    
                    focus = 1;
                } else {
                    
                    const falloffProgress = Math.min(1, (distance - plateauRadius) / falloffDistance);
                    focus = Math.pow(1 - falloffProgress, 3); 
                }
                cardFocusValues[i] = focus;
            });

            applyCardTransforms();
            scrollRafId = null;
        });
    }

    function applyCardTransforms() {
        postCards.forEach((card, i) => {
            const focus = cardFocusValues[i];
            
            const scale = 1 + focus * 0.02;
            
            const gyroScale = 0.3 + focus * 0.7;
            const rotX = currentRotateX * gyroScale;
            const rotY = currentRotateY * gyroScale;
            
            const shadowOpacity = 0.3 + focus * 0.3;
            const shadowBlur = 2 + focus * 4;
            
            const opacity = 0.4 + focus * 0.6;

            card.style.transform = `perspective(1000px) rotateX(${rotX}deg) rotateY(${rotY}deg) scale(${scale})`;
            card.style.boxShadow = `0 ${1 + focus * 2}px ${shadowBlur}px rgba(0, 0, 0, ${shadowOpacity})`;
            card.style.opacity = opacity;
        });
    }

    function handleCardOrientation(event) {
        if (event.beta === null || event.gamma === null) return;

        
        const orientation = screen.orientation?.angle ?? window.orientation ?? 0;
        let beta, gamma;

        if (orientation === 90) {
            beta = event.gamma;
            gamma = -event.beta;
        } else if (orientation === -90 || orientation === 270) {
            beta = -event.gamma;
            gamma = event.beta;
        } else if (orientation === 180) {
            beta = -event.beta;
            gamma = -event.gamma;
        } else {
            beta = event.beta;
            gamma = event.gamma;
        }

        latestBeta = beta;
        latestGamma = gamma;

        if (!gyroRafId) {
            gyroRafId = requestAnimationFrame(() => {
                
                if (gyroBaselineBeta === null) {
                    gyroBaselineBeta = latestBeta;
                    gyroBaselineGamma = latestGamma;
                }

                
                gyroBaselineBeta += (latestBeta - gyroBaselineBeta) * GYRO_DRIFT_RATE;
                gyroBaselineGamma += (latestGamma - gyroBaselineGamma) * GYRO_DRIFT_RATE;

                
                let relativeBeta = latestBeta - gyroBaselineBeta;
                let relativeGamma = latestGamma - gyroBaselineGamma;

                
                if (Math.abs(relativeBeta) > 40 || Math.abs(relativeGamma) > 40) {
                    gyroBaselineBeta = latestBeta;
                    gyroBaselineGamma = latestGamma;
                    relativeBeta = 0;
                    relativeGamma = 0;
                }

                
                currentRotateY = Math.max(-8, Math.min(8, relativeGamma * 0.35));
                currentRotateX = Math.max(-8, Math.min(8, relativeBeta * -0.35));

                applyCardTransforms();
                gyroRafId = null;
            });
        }
    }

    function enableCardGyroscope() {
        window.addEventListener('deviceorientation', handleCardOrientation, { passive: true });
    }

    
    window.addEventListener('scroll', updateCardFocus, { passive: true });
    
    updateCardFocus();

    
    if (typeof DeviceOrientationEvent.requestPermission === 'function') {
        
        enableCardGyroscope();

        
        const requestPermission = () => {
            if (cardGyroPermissionRequested) return;
            cardGyroPermissionRequested = true;

            DeviceOrientationEvent.requestPermission()
                .then(state => {
                    if (state === 'granted') {
                        enableCardGyroscope();
                    }
                })
                .catch(() => {
                    cardGyroPermissionRequested = false;
                });
        };
        document.addEventListener('touchstart', requestPermission, { once: true, passive: true });
        document.addEventListener('touchend', requestPermission, { once: true, passive: true });
        document.addEventListener('click', requestPermission, { once: true, passive: true });
    } else {
        
        enableCardGyroscope();
    }
} else {
    
    postCards.forEach(card => {
        let rafId = null;
        let mouseX = 0, mouseY = 0;

        card.addEventListener('mousemove', (e) => {
            const rect = card.getBoundingClientRect();
            mouseX = e.clientX - rect.left;
            mouseY = e.clientY - rect.top;

            if (!rafId) {
                rafId = requestAnimationFrame(() => {
                    const centerX = rect.width / 2;
                    const centerY = rect.height / 2;
                    const rotateX = (mouseY - centerY) / centerY * -0.8;
                    const rotateY = (mouseX - centerX) / centerX * 0.8;
                    const normalizedY = (centerY - mouseY) / centerY;
                    const isDarkMode = document.body.classList.contains('dark');
                    const baseOpacity = isDarkMode ? 0.35 : 0.15;
                    const opacityRange = isDarkMode ? 0.25 : 0.15;
                    const shadowOpacity = Math.max(0, baseOpacity + normalizedY * opacityRange);
                    const blur = isDarkMode ? 1 : 0.5;
                    card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) translateY(-1px) scale(1.004)`;
                    card.style.boxShadow = `0 1px ${blur}px rgba(0, 0, 0, ${shadowOpacity})`;
                    rafId = null;
                });
            }
        });
        card.addEventListener('mouseleave', () => {
            if (rafId) {
                cancelAnimationFrame(rafId);
                rafId = null;
            }
            card.style.transform = '';
            card.style.boxShadow = '';
        });
    });
}

if (isHomePage) {
    
    setTimeout(triggerRandomScan, 3000 + Math.random() * 2000);
} else {
    
    setTimeout(() => {
        const logo = document.querySelector('.logo a');
        if (logo) scanElement(logo);

        setTimeout(() => {
            const titles = Array.from(document.querySelectorAll('.post-title'));
            if (titles.length > 0) {
                scanElement(titles[Math.floor(Math.random() * titles.length)]);
            }
            
            setTimeout(triggerRandomScan, 4000 + Math.random() * 6000);
        }, 400);
    }, 800);
}


const tocBox = document.querySelector('.toc');
if (tocBox) {
    const tocDetails = tocBox.querySelector('details');
    if (tocDetails) {
        tocBox.addEventListener('click', (e) => {
            
            if (e.target.tagName === 'A') return;
            
            if (e.target.closest('summary')) return;
            tocDetails.open = !tocDetails.open;
        });
    }
}
</script>
<div class="headerfooter">
    <sub><sup><sub>..</sub></sup></sub>
</div>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            document.documentElement.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            document.documentElement.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
