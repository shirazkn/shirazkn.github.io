<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head>
	<meta name="generator" content="Hugo 0.154.5"><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Shiraz</title>

<meta name="description" content="">
<meta name="author" content="">
<link rel="canonical" href="https://shirazkn.github.io/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.b78659d76588cf580b3b8c681621f1110b38b5c6048b3adb139c26417d83bf35.css" integrity="sha256-t4ZZ12WIz1gLO4xoFiHxEQs4tcYEizrbE5wmQX2DvzU=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://shirazkn.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://shirazkn.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://shirazkn.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://shirazkn.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://shirazkn.github.io/favicon.ico">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://shirazkn.github.io/index.xml" title="rss">
<link rel="alternate" type="application/json" href="https://shirazkn.github.io/index.json" title="json">
<link rel="alternate" hreflang="en" href="https://shirazkn.github.io/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><script>
(function() {
    var pref = localStorage.getItem("pref-theme");
    if (pref === "dark" || (!pref && window.matchMedia("(prefers-color-scheme: dark)").matches)) {
        document.documentElement.classList.add("dark");
    }
})();
</script>

<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      packages: {'[+]': ['mathtools', 'amscd']},
      displayMath: [['\\[', '\\]'], ['$$', '$$']],  
      inlineMath: [['\\(', '\\)'], ['$', '$']]  
    },
    loader:{
      load: ['ui/safe', '[tex]/mathtools', '[tex]/amscd']
    },
  };
</script>

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IM+Fell+DW+Pica">

<meta property="og:url" content="https://shirazkn.github.io/">
  <meta property="og:site_name" content="Shiraz">
  <meta property="og:title" content="Shiraz">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Shiraz">
<meta name="twitter:description" content="">

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "Shiraz",
  "url": "https://shirazkn.github.io/",
  "description": "",
  "logo": "https://shirazkn.github.io/favicon.ico",
  "sameAs": [
      "https://www.github.com/shirazkn", "https://www.linkedin.com/in/shiraz-k/"
  ]
}
</script>
</head>
<body class="list" id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://shirazkn.github.io/" accesskey="h" title="Shiraz (Alt + H)">Shiraz</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://shirazkn.github.io/archives/" title="archives">
                    <span>archives</span>
                </a>
            </li>
            <li>
                <a href="https://shirazkn.github.io/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li>
            <li>
                <a href="https://shirazkn.github.io/search/" title="search (Alt &#43; /)" accesskey=/>
                    <span>search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> <script type="application/javascript" src="https://shirazkn.github.io/js/logo.min.5e50c9768a936a565683fe460fcb50e9d8889807724c813e2bb55c541c61dee4.js"></script>

<article class="first-entry home-info">
    <header class="entry-header">
        <h1></h1>
    </header>
    
    <div id=logo-s>
        <div id=svg-rotator><svg data-name="BLACK S BELOW" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1500 1500">
    <defs>
        <radialGradient id="black-gradient" cx="0.6" cy="0.6" r="0.8" spreadMethod="pad">
            <stop offset="0%" stop-color="var(--color-1)" />
            <stop offset="100%" stop-color="var(--color-2)" />
        </radialGradient>
        <radialGradient id="darkpink-gradient" cx="0.6" cy="0.4" r="0.6" spreadMethod="pad">
            <stop offset="0%" stop-color="var(--color-1)" />
            <stop offset="100%" stop-color="var(--color-2)" />
        </radialGradient>
        <linearGradient id="pink-gradient" x1="0%" x2="90%" y1="100%" y2="0%" spreadMethod="pad">
            <stop id="stop-1" offset="20%" stop-color="var(--color-1)" />
            <stop id="stop-2" offset="30%" stop-color="var(--color-2)" />
            <stop id="stop-3" offset="65%" stop-color="var(--color-3)" />
            <stop id="stop-4" offset="71%" stop-color="var(--color-4)" />
        </linearGradient>
    </defs>
    <path id="black-path" data-name="Color Fill 8" class="cls-black" d="M1034,366c35.5-54.894,62.83-131.321,34-185-42.55-79.227-252.733-142.207-517.087-23C269,285.116,211.87,475.025,299.189,544.55c82.946,66.043,364.329,145.659,669.47,283.67,291.081,131.651,351.751,263.87,377.721,323.73,25.19,58.08,15.73,210.66-251.53,244.18-281.67,35.34-428.145-31.29-568.769-91.36C380.3,1242.5,135.822,1068.23,200.539,937.684c22.031-44.44,162.2-78.073,162.2-78.073S-6.819,747.32,22.271,597.628C-8.014,706.162-5.483,791,46.614,917.252c107.977,261.668,401.817,401.038,539.353,452.9,144.976,54.68,363.9,72.5,566.213,52.57,181.07-17.84,280.68-156.89,265.48-246.24-14.67-86.23-155.94-285.966-480.363-417.929-338.391-137.644-513.57-240.424-552.027-285.2-37-43.08-85.188-130.385,159.836-262.9C773.258,87.064,902.781,136.941,968.4,177.612c74.975,46.471,36.675,132.184-14.524,184.764C951.191,361.005,1007.52,406.869,1034,366ZM856.987,381.907"/>
    <path id="darkpink-path" data-name="Color Fill 9" class="cls-darkpink" d="M1202.03,177.735c-37.6-120.785-276.2-223.8-638.372-72.129C200.505,257.684,94.407,473.08,106.243,569.371c10.423,84.791,72.589,99.14,460.314,196.7C1006.97,876.9,1269.32,1065.45,1254.47,1208.32s-307,229.87-612.464,99.34c-478.923-204.64-157.7-394.118-123.7-411.68s53.909-27.163,53.909-27.163-119.741-29.718-233.857-4.79C221.69,889.512,14.625,880.338,8,733-0.919,534.664,127.828,324.691,345.524,185.772c345.163-220.26,633.9-201.14,784.746-142.023C1291.03,106.749,1226.51,256.356,1202.03,177.735ZM474.148,1033.64c-96.166,111.42,91.519,248.65,321.261,287.76,267.161,45.47,400.041-31.07,397.571-134.8-4.32-181.67-518.059-303.891-518.059-303.891S538.815,946.623,474.148,1033.64Z"/>
    <path id="pink-path" data-name="Color Fill 7" class="cls-pink" d="M920.588,705.98A54.237,54.237,0,0,1,914,712c-68.941,54-99.809,76.651-132.779,99.385C634.878,915.185,499.363,994.707,476,1030c-28.209,42.61-106.167,144.21,129.6,261.4C263.32,1128.82,369.312,985.81,457.289,928.863c95-61.489,116.511-42.622,375.256-232.986,278.105-204.6,395.345-396.479,375.6-492.215-13.26-64.248-26.78-166.524-214.247-193.184C1111.79,26.143,1208.58,58.147,1242.6,154,1286.54,277.791,1215.4,465.893,920.588,705.98Zm73.305-695.5Q984.039,9.168,974,8,984.268,9.1,993.893,10.478Zm49.277,343.71C1000.81,422.852,929.154,494.2,851.246,558.347a1242.69,1242.69,0,0,1-136.46,101.785C678.145,684.989,643.068,706.965,612,725q-10.55,6.124-20.336,11.327C367.933,870.63,190.273,946.409,60,837,10.866,791.141-9.5,730.015,16.832,617.288,10.135,808.95,317.468,785.519,463,719q29.888-13.66,58.881-28.2C623.955,637.205,753,552.521,854.058,463.538,860.041,458.1,866.022,452.605,872,447c36.433-34.16,67.221-66.947,91.847-97.613C1000.33,301.726,1021.65,256.166,1019,217,1008.54,62.388,731,102,731,102s96.054-19,183-4C1079.18,126.489,1123.42,205.462,1043.17,354.188ZM1591,603m77,385"/>
  </svg>      
        </div>    
    </div>
    <footer class="entry-footer">
        <div class="social-icons" >
    <a href="https://www.github.com/shirazkn" target="_blank" rel="noopener noreferrer me"
        title="Github">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
    </a>
    <a href="https://www.linkedin.com/in/shiraz-k/" target="_blank" rel="noopener noreferrer me"
        title="LinkedIn">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path>
    <rect x="2" y="9" width="4" height="12"></rect>
    <circle cx="4" cy="4" r="2"></circle>
</svg>
    </a>
</div>

    </footer>
    <div class="entry-content-2">
        Welcome to my recreational mathematics blog. 
        <a href="/about/" class=inline-link>Here</a>'s a good place to start.
    </div>
</article>

<article class="post-entry"> 
  <div class="entry-bg" style="background-image: url('/post-images/geometry/frames.png');"></div>
  <header class="entry-header">
    <h2>Representing Spatial Velocities
    </h2>
  </header>
  <div class="entry-content">
    <p>I’ve been going through Russ Tedrake’s notes on robotics, which got me thinking about their so-called monogram notation. The result of this deliberation was a new notation for spatial velocities that bridges the gap between abstract Lie groups and their applications to robotics and computer graphics.</p>
  </div>
  <footer class="entry-footer"><span title='2025-11-13 21:23:17 -0500 EST'>November 13, 2025</span></footer>
  <a class="entry-link" aria-label="post link to Representing Spatial Velocities" href="https://shirazkn.github.io/posts/robotics/"></a>
</article>

<article class="post-entry"> 
  <div class="entry-bg" style="background-image: url('/post-images/geometry/fiber_bundle.png');"></div>
  <header class="entry-header">
    <h2>Principal Bundles
    </h2>
  </header>
  <div class="entry-content">
    <p>A principal bundle is a fiber bundle, that additionally has the right-action of a group that preserves fibers. Beginning with coset spaces, we look at some interesting examples of principal bundles and the things we can do with them.</p>
  </div>
  <footer class="entry-footer"><span title='2025-10-24 20:55:32 -0400 EDT'>October 24, 2025</span></footer>
  <a class="entry-link" aria-label="post link to Principal Bundles" href="https://shirazkn.github.io/posts/bundles/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Differentials in Lie Theory
    </h2>
  </header>
  <div class="entry-content">
    <p>Some results about the differentials (i.e., pushforwards) of the exponential and logarithm maps of a Lie group. I rely extensively on the interpretation of tangent vectors as equivalence classes of curves.</p>
  </div>
  <footer class="entry-footer"><span title='2025-01-13 12:46:04 -0500 EST'>January 13, 2025</span></footer>
  <a class="entry-link" aria-label="post link to Differentials in Lie Theory" href="https://shirazkn.github.io/posts/lemmas/"></a>
</article>

<article class="post-entry"> 
  <div class="entry-bg" style="background-image: url('/post-images/lie_groups/Calculus_of_Variations.png');"></div>
  <header class="entry-header">
    <h2>Euler-Poincaré Equations
    </h2>
  </header>
  <div class="entry-content">
    <p>Poincaré’s 1901 paper introduces (in just a humble 3 pages) the Euler-Poincaré equations, which are the specialization of the Euler-Lagrange equations to the case where a Lie group acts on the configuration manifold. I work through Poincaré’s paper without making too many identifications.</p>
  </div>
  <footer class="entry-footer"><span title='2024-12-19 08:18:04 -0500 EST'>December 19, 2024</span></footer>
  <a class="entry-link" aria-label="post link to Euler-Poincaré Equations" href="https://shirazkn.github.io/posts/ep/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Harmonic Analysis
    </h2>
  </header>
  <div class="entry-content">
    <p>The Fourier transform maps a complex-valued function to a function on its Pontryagin dual space. Generalizations of this concept to non-Abelian compact and locally compact Lie groups are reviewed.</p>
  </div>
  <footer class="entry-footer"><span title='2024-12-12 13:02:50 +0530 +0530'>December 12, 2024</span></footer>
  <a class="entry-link" aria-label="post link to Harmonic Analysis" href="https://shirazkn.github.io/posts/harmonic-analysis/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Classical Mechanics on Manifolds
    </h2>
  </header>
  <div class="entry-content">
    <p>Despite having encountered the Lagrangian and Hamiltonian formalisms of mechanics several times in a variety of engineering and physics settings, I had never been able to retain it in my memory. In this post, I would like to collect my thoughts on their differential geometric treatment, which assumes a very simple and memorable form once we introduce the language of symplectic geometry.</p>
  </div>
  <footer class="entry-footer"><span title='2024-12-09 14:45:16 +0530 +0530'>December 9, 2024</span></footer>
  <a class="entry-link" aria-label="post link to Classical Mechanics on Manifolds" href="https://shirazkn.github.io/posts/symplectic/"></a>
</article>

<article class="post-entry"> 
  <div class="entry-bg" style="background-image: url('/post-images/differential_forms/sphere.png');"></div>
  <header class="entry-header">
    <h2>The Levi-Civita Connection
    </h2>
  </header>
  <div class="entry-content">
    <p>Here, I solve Problem 5-5 from John Lee’s book on Riemannian Manifolds, which demonstrates the non-flatness of the 2-sphere. This problem is particularly interesting because it serves as the motivating example for a later chapter in the book on curvature.</p>
  </div>
  <footer class="entry-footer"><span title='2024-03-24 10:43:16 -0400 EDT'>March 24, 2024</span></footer>
  <a class="entry-link" aria-label="post link to The Levi-Civita Connection" href="https://shirazkn.github.io/posts/sphere/"></a>
</article>

<article class="post-entry"> 
  <div class="entry-bg" style="background-image: url('/post-images/lie_groups/left-multiplication-june.png');"></div>
  <header class="entry-header">
    <h2>Lie Groups as Riemannian Manifolds
    </h2>
  </header>
  <div class="entry-content">
    <p>A Lie group is a group that is also a (continuous, differentiable) topological space. To measure lengths and volumes (and relatedly, to define and integrate probability densities) we need to endow the group with additional structure so that it is not merely a manifold, but a Riemannian manifold.</p>
  </div>
  <footer class="entry-footer"><span title='2024-01-30 09:53:05 -0500 EST'>January 30, 2024</span></footer>
  <a class="entry-link" aria-label="post link to Lie Groups as Riemannian Manifolds" href="https://shirazkn.github.io/posts/lie-groups_riemannian/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Lie Groups: Construction and Geometry
    </h2>
  </header>
  <div class="entry-content">
    <p>There are multiple ways to construct new groups from old ones. I provide an intuition for how these constructions work, and also go over some of the additional structures that can be imposed on Lie groups, paving the path towards doing differential geometry and calculus on Lie groups.</p>
  </div>
  <footer class="entry-footer"><span title='2024-01-24 14:20:59 -0500 EST'>January 24, 2024</span></footer>
  <a class="entry-link" aria-label="post link to Lie Groups: Construction and Geometry" href="https://shirazkn.github.io/posts/lie-groups_construction/"></a>
</article>

<article class="post-entry"> 
  <div class="entry-bg" style="background-image: url('/post-images/lie_groups/left-multiplication.png');"></div>
  <header class="entry-header">
    <h2>The Lie Group-Lie Algebra Correspondence
    </h2>
  </header>
  <div class="entry-content">
    <p>A topological group is a set of elements that has both a group operation and a topology. The group operation satisfies the usual axioms (same as those of finite groups), and the presence of a topology lets us say things like ’the group is connected’ and ’the group operation is continuous&#39;.</p>
  </div>
  <footer class="entry-footer"><span title='2024-01-15 07:24:59 -0500 EST'>January 15, 2024</span></footer>
  <a class="entry-link" aria-label="post link to The Lie Group-Lie Algebra Correspondence" href="https://shirazkn.github.io/posts/lie-groups/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="next" href="https://shirazkn.github.io/page/2/">Next&nbsp;&nbsp;»
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
    
    
    
    
    
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><script>

document.addEventListener('touchstart', function() {}, { passive: true });


function syncDarkClass() {
    const isDark = document.documentElement.dataset.theme === 'dark';
    document.documentElement.classList.toggle('dark', isDark);
    document.body.classList.toggle('dark', isDark);
}
syncDarkClass();


const themeToggle = document.getElementById('theme-toggle');
if (themeToggle) {
    themeToggle.addEventListener('click', () => {
        setTimeout(syncDarkClass, 0);
    });
}


document.querySelectorAll('.logo a, .post-title').forEach(el => {
    el.innerHTML = el.textContent.trim().split(' ').map(word =>
        `<span class="hover-word">${word.split('').map(char =>
            `<span class="hover-letter">${char}</span>`
        ).join('')}</span>`
    ).join(' ');
});


const isDark = () => document.body.classList.contains('dark');
const hoverColorsDark = ['#ff51af', '#ff51af', '#f161ac', '#f161ac', '#db327e', '#db327e', '#3b82f6', '#38bdf8'];
const hoverColorsLight = ['#ff51af', '#ff51af', '#e83a89', '#e83a89', '#f542a1', '#d6306f', '#3b9eff', '#00c2ff'];
const getHoverColors = () => isDark() ? hoverColorsDark : hoverColorsLight;
document.querySelectorAll('.hover-letter').forEach(letter => {
    letter.addEventListener('mouseenter', () => {
        const colors = getHoverColors();
        letter.style.color = colors[Math.floor(Math.random() * colors.length)];
    });
    letter.addEventListener('mouseleave', () => {
        letter.style.color = '';
    });
});


let scanInProgress = false;
const scanElement = (el) => {
    if (scanInProgress) return;
    scanInProgress = true;
    const letters = el.querySelectorAll('.hover-letter');
    const colors = getHoverColors();
    const totalTime = letters.length * 50 + 100;
    letters.forEach((letter, i) => {
        setTimeout(() => {
            letter.style.transition = 'top 0.05s ease-out, color 0s';
            letter.style.color = colors[Math.floor(Math.random() * colors.length)];
            letter.style.top = '-0.08em';
            setTimeout(() => {
                letter.style.transition = '';
                letter.style.color = '';
                letter.style.top = '';
            }, 100);
        }, i * 50);
    });
    setTimeout(() => { scanInProgress = false; }, totalTime);
};

let lastScannedEl = null;
const triggerRandomScan = () => {
    const logos = Array.from(document.querySelectorAll('.logo a'));
    const titles = Array.from(document.querySelectorAll('.post-title'));
    
    const pickLogo = Math.random() < 0.5 && logos.length > 0;
    let elements = pickLogo ? logos : titles;
    
    if (lastScannedEl && elements.length > 1) {
        elements = elements.filter(el => el !== lastScannedEl);
    }
    if (elements.length > 0) {
        const el = elements[Math.floor(Math.random() * elements.length)];
        lastScannedEl = el;
        scanElement(el);
    }
    
    setTimeout(triggerRandomScan, 4000 + Math.random() * 6000);
};


const isHomePage = document.querySelector('.first-entry.home-info') !== null;





const CARD_CONFIG = {
    
    hoverLift: 4,
    
    maxRotation: 0.8,
    
    shadowOpacityLight: 0.22,      
    shadowOpacityDark: 0.45,       
    shadowOpacityRange: 0.12,      
    
    shadowBlurBase: 1.5,           
    shadowBlurHover: 2.5,          
    shadowYOffsetBase: 1,          
    shadowYOffsetHover: 2,         
};



const postCards = document.querySelectorAll('.post-entry');
const isTouchDevice = window.matchMedia('(pointer: coarse)').matches;

if (isTouchDevice && window.isSecureContext && 'DeviceOrientationEvent' in window) {
    
    
    let gyroBaselineBeta = null;
    let gyroBaselineGamma = null;
    const GYRO_DRIFT_RATE_MIN = 0.0008;  
    const GYRO_DRIFT_RATE_MAX = 0.25;   
    let gyroRafId = null;
    let latestBeta = null, latestGamma = null;
    let cardGyroPermissionRequested = false;

    
    let currentRotateX = 0, currentRotateY = 0;
    let currentTranslateX = 0, currentTranslateY = 0;

    
    let cardFocusValues = new Array(postCards.length).fill(0);
    let transformRafId = null;

    
    function scheduleTransformUpdate() {
        if (transformRafId) return;
        transformRafId = requestAnimationFrame(() => {
            applyCardTransforms();
            transformRafId = null;
        });
    }

    
    const observerThresholds = [0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0];
    const cardObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            const index = Array.prototype.indexOf.call(postCards, entry.target);
            if (index === -1) return;

            
            const ratio = entry.intersectionRatio;
            
            cardFocusValues[index] = ratio * ratio;
        });
        scheduleTransformUpdate();
    }, {
        threshold: observerThresholds,
        
        rootMargin: '-15% 0px -15% 0px'
    });

    
    postCards.forEach(card => cardObserver.observe(card));

    function applyCardTransforms() {
        
        const baseGyroX = currentRotateX * 0.3;
        const baseGyroY = currentRotateY * 0.3;
        const gyroRangeX = currentRotateX * 0.7;
        const gyroRangeY = currentRotateY * 0.7;
        
        const baseTransX = currentTranslateX * 0.3;
        const baseTransY = currentTranslateY * 0.3;
        const transRangeX = currentTranslateX * 0.7;
        const transRangeY = currentTranslateY * 0.7;

        for (let i = 0; i < postCards.length; i++) {
            const focus = cardFocusValues[i];
            const card = postCards[i];

            
            const rotX = baseGyroX + gyroRangeX * focus;
            const rotY = baseGyroY + gyroRangeY * focus;
            const transX = baseTransX + transRangeX * focus;
            const transY = baseTransY + transRangeY * focus;

            card.style.transform = `perspective(1000px) rotateX(${rotX}deg) rotateY(${rotY}deg) translateX(${transX}px) translateY(${transY}px) scale(${1 + focus * 0.02})`;
            card.style.boxShadow = `0 ${1 + focus * 2}px ${2 + focus * 4}px rgba(0,0,0,${0.3 + focus * 0.3})`;
            card.style.opacity = 0.25 + focus * 0.75;
        }
    }

    function handleCardOrientation(event) {
        if (event.beta === null || event.gamma === null) return;

        
        const orientation = screen.orientation?.angle ?? window.orientation ?? 0;
        let beta, gamma;

        if (orientation === 90) {
            beta = event.gamma;
            gamma = -event.beta;
        } else if (orientation === -90 || orientation === 270) {
            beta = -event.gamma;
            gamma = event.beta;
        } else if (orientation === 180) {
            beta = -event.beta;
            gamma = -event.gamma;
        } else {
            beta = event.beta;
            gamma = event.gamma;
        }

        latestBeta = beta;
        latestGamma = gamma;

        if (!gyroRafId) {
            gyroRafId = requestAnimationFrame(() => {
                
                if (gyroBaselineBeta === null) {
                    gyroBaselineBeta = latestBeta;
                    gyroBaselineGamma = latestGamma;
                }

                
                const relativeBeta = latestBeta - gyroBaselineBeta;
                const relativeGamma = latestGamma - gyroBaselineGamma;

                
                const maxTilt = Math.max(Math.abs(relativeBeta), Math.abs(relativeGamma));
                const tiltFactor = Math.min(1, maxTilt / 30);  
                
                const driftRate = GYRO_DRIFT_RATE_MIN + tiltFactor * tiltFactor * tiltFactor * (GYRO_DRIFT_RATE_MAX - GYRO_DRIFT_RATE_MIN);

                
                gyroBaselineBeta += (latestBeta - gyroBaselineBeta) * driftRate;
                gyroBaselineGamma += (latestGamma - gyroBaselineGamma) * driftRate;

                
                currentRotateY = Math.max(-6, Math.min(6, relativeGamma * 0.25));
                currentRotateX = Math.max(-6, Math.min(6, relativeBeta * -0.25));

                
                currentTranslateX = Math.max(-4, Math.min(4, relativeGamma * 0.16));
                currentTranslateY = Math.max(-3, Math.min(3, relativeBeta * 0.14));

                scheduleTransformUpdate();
                gyroRafId = null;
            });
        }
    }

    function enableCardGyroscope() {
        window.addEventListener('deviceorientation', handleCardOrientation, { passive: true });
    }

    
    applyCardTransforms();

    
    postCards.forEach((card, index) => {
        let touchStartTime = 0;

        card.addEventListener('touchstart', (e) => {
            touchStartTime = Date.now();
            const focus = cardFocusValues[index];
            
            card.style.transition = 'transform 0.08s ease-out, box-shadow 0.08s ease-out';
            card.style.transform = `perspective(1000px) rotateX(0deg) rotateY(0deg) scale(${0.97 + focus * 0.01})`;
            card.style.boxShadow = `0 0.5px 1px rgba(0,0,0,0.2)`;
        }, { passive: true });

        card.addEventListener('touchend', () => {
            
            card.style.transition = 'transform 0.15s ease-out, box-shadow 0.15s ease-out';
            setTimeout(() => {
                card.style.transition = '';
                scheduleTransformUpdate();
            }, 150);
        }, { passive: true });

        card.addEventListener('touchcancel', () => {
            card.style.transition = '';
            scheduleTransformUpdate();
        }, { passive: true });
    });

    
    if (typeof DeviceOrientationEvent.requestPermission === 'function') {
        
        enableCardGyroscope();

        
        const requestPermission = () => {
            if (cardGyroPermissionRequested) return;
            cardGyroPermissionRequested = true;

            DeviceOrientationEvent.requestPermission()
                .then(state => {
                    if (state === 'granted') {
                        enableCardGyroscope();
                    }
                })
                .catch(() => {
                    cardGyroPermissionRequested = false;
                });
        };
        document.addEventListener('touchstart', requestPermission, { once: true, passive: true });
        document.addEventListener('touchend', requestPermission, { once: true, passive: true });
        document.addEventListener('click', requestPermission, { once: true, passive: true });
    } else {
        
        enableCardGyroscope();
    }
} else {
    
    
    let currentMouseCard = null;
    let lastMouseX = 0, lastMouseY = 0;

    postCards.forEach(card => {
        let rafId = null;
        let isPressed = false;

        card.addEventListener('mouseenter', () => {
            currentMouseCard = card;
        });

        card.addEventListener('mousemove', (e) => {
            if (isPressed) return; 
            lastMouseX = e.clientX;
            lastMouseY = e.clientY;

            if (!rafId) {
                rafId = requestAnimationFrame(() => {
                    if (isPressed) { rafId = null; return; }
                    const rect = card.getBoundingClientRect();
                    const mouseX = lastMouseX - rect.left;
                    const mouseY = lastMouseY - rect.top;
                    const centerX = rect.width / 2;
                    const centerY = rect.height / 2;
                    const rotateX = (mouseY - centerY) / centerY * -CARD_CONFIG.maxRotation;
                    const rotateY = (mouseX - centerX) / centerX * CARD_CONFIG.maxRotation;
                    const normalizedY = (centerY - mouseY) / centerY;
                    const isDarkMode = document.body.classList.contains('dark');
                    const baseOpacity = isDarkMode ? CARD_CONFIG.shadowOpacityDark : CARD_CONFIG.shadowOpacityLight;
                    const shadowOpacity = Math.max(0, baseOpacity + normalizedY * CARD_CONFIG.shadowOpacityRange);
                    card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) translateZ(${CARD_CONFIG.hoverLift}px)`;
                    card.style.boxShadow = `0 ${CARD_CONFIG.shadowYOffsetHover}px ${CARD_CONFIG.shadowBlurHover}px rgba(0, 0, 0, ${shadowOpacity})`;
                    rafId = null;
                });
            }
        });

        card.addEventListener('mousedown', () => {
            isPressed = true;
            card.style.transform = 'scale(0.99)';
            card.style.boxShadow = '';
        });

        card.addEventListener('mouseup', () => {
            isPressed = false;
        });

        card.addEventListener('mouseleave', () => {
            if (rafId) {
                cancelAnimationFrame(rafId);
                rafId = null;
            }
            isPressed = false;
            card.style.transform = '';
            card.style.boxShadow = '';
            currentMouseCard = null;
        });
    });

}

if (isHomePage) {
    
    setTimeout(triggerRandomScan, 3000 + Math.random() * 2000);
} else {
    
    setTimeout(() => {
        const logo = document.querySelector('.logo a');
        if (logo) scanElement(logo);

        setTimeout(() => {
            const titles = Array.from(document.querySelectorAll('.post-title'));
            if (titles.length > 0) {
                scanElement(titles[Math.floor(Math.random() * titles.length)]);
            }
            
            setTimeout(triggerRandomScan, 4000 + Math.random() * 6000);
        }, 400);
    }, 800);
}


const tocBox = document.querySelector('.toc');
if (tocBox) {
    const tocDetails = tocBox.querySelector('details');
    if (tocDetails) {
        tocBox.addEventListener('click', (e) => {
            
            if (e.target.tagName === 'A') return;
            
            if (e.target.closest('summary')) return;
            tocDetails.open = !tocDetails.open;
        });
    }
}
</script>
<div class="headerfooter">
    <sub><sup><sub>..</sub></sup></sub>
</div>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            document.documentElement.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            document.documentElement.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
